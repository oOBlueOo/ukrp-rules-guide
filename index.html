<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UKRP Rules & Reference Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Define refined accent colors for visual distinction */
            --color-general: #A370F0; /* Vibrant Purple */
            --color-whitelist: #FFC107; /* Gold/Warning */
            --color-core-rp: #00BFFF; /* Electric Blue */
            --color-combat: #E74C3C; /* Danger Red */
            --color-crime: #2ECC71; /* Vibrant Green */
            --color-economy: #3498DB; /* Sky Blue */
            --color-zones: #F39C12; /* Orange */
            --color-aircraft: #BDC3C7; /* Light Gray */
            --color-new-rule: rgba(46, 204, 113, 0.15); /* Soft Green tint for new rules */

            /* Theme Base Colors (kept dark for consistency) */
            --bg-primary: #0d1117; 
            --bg-secondary: #161b22;
            --border-color: #30363d;
            --text-light: #c9d1d9;
            --text-accent: #58a6ff;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-light);
        }
        
        /* HEADER Gradient Effect */
        .fancy-header {
            background: var(--bg-secondary);
            background: linear-gradient(180deg, #1f242c 0%, var(--bg-secondary) 100%);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3); /* Stronger shadow */
        }

        /* STICKY NAV & SEARCH BAR */
        .sticky-nav {
            top: 1rem;
            max-height: calc(100vh - 2rem);
            overflow-y: auto;
            -ms-overflow-style: none;
            scrollbar-width: none;
            background-color: var(--bg-secondary);
            border-color: var(--border-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        .sticky-nav::-webkit-scrollbar {
            display: none;
        }

        /* SECTION Header Colors (Dynamically set by JS) */
        .section-header {
            border-left: 6px solid var(--accent-color); /* Thicker border */
            padding-left: 1.25rem;
            font-size: 1.875rem; /* text-3xl */
        }
        .rule-section {
            background-color: var(--bg-secondary);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.25);
            transition: transform 0.3s ease;
        }
        .rule-section:hover {
            transform: translateY(-2px);
        }

        /* TABLE STYLES */
        .rule-table th, .rule-table td {
            padding: 16px 14px; /* Increased padding */
            border-bottom: 1px solid var(--border-color);
            text-align: left;
        }
        .rule-table th {
            background-color: #1f242c;
            color: var(--text-accent); 
            font-weight: 800; /* Bolder header text */
            font-size: 0.85rem;
        }
        
        /* Rule Item Hover & Transitions */
        .rule-item {
            background-color: #1a2027; /* Base row color */
        }
        .rule-item:hover {
            background-color: #21262d; /* Distinct hover color */
            box-shadow: inset 3px 0 0 0 var(--text-accent); /* Subtle line on hover */
        }
        
        /* NEW Rule Highlight */
        .rule-new {
            background-color: var(--color-new-rule) !important;
            font-weight: 700;
        }
        .rule-new td {
            border-bottom: 2px solid var(--color-crime) !important; /* Emphasize new rule rows with a distinct color */
        }

        /* Star Rating styles */
        .rating-group {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
            gap: 0.25rem;
        }
        .rating-group > label svg {
            fill: #4b5563; /* Gray */
            transition: fill 0.2s ease;
        }
        .rating-group > input:checked ~ label svg,
        .rating-group > label:hover ~ label svg,
        .rating-group > label:hover svg {
            fill: var(--color-whitelist); /* Gold accent */
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8 p-6 fancy-header rounded-xl border border-[#444c56] flex items-center">
            <img src="https://unitingkingdomsrp.co.uk/logo_1.png" alt="UKRP Logo" 
                 class="h-20 w-20 mr-4 rounded-full object-cover border-4 border-white shadow-2xl">
            
            <div>
                <h1 class="text-5xl font-extrabold text-white mb-1 tracking-tight">UKRP Server Rules</h1>
                <p class="text-xl text-[#8b949e] font-light">All players must read and understand this official guide.</p>
            </div>
        </header>

        <div class="lg:grid lg:grid-cols-4 lg:gap-8">
            
            <nav id="sideNav" class="hidden lg:block lg:col-span-1 sticky-nav p-5 rounded-xl self-start">
                <h3 class="text-xl font-bold text-white mb-4 border-b border-[#444c56] pb-2">Rule Categories</h3>
                </nav>

            <div class="lg:col-span-3">
                
                <div class="mb-8 sticky top-4 z-20 bg-[var(--bg-primary)] pt-4 -mt-4 shadow-xl rounded-lg p-3 border border-[#444c56]">
                    <div class="relative">
                        <input type="text" id="ruleSearch" placeholder="üîç Search by topic, rule number, or summary..."
                               class="search-input w-full p-3 pr-10 rounded-lg bg-[#21262d] text-white border border-[#444c56] focus:outline-none focus:ring-2 focus:ring-[var(--color-whitelist)] transition duration-150 shadow-inner">
                        <button id="clearSearch" class="absolute right-0 top-0 mt-3 mr-3 text-[#8b949e] hover:text-white hidden" aria-label="Clear Search">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                    <div id="noResults" class="hidden text-center mt-4 text-xl text-[var(--color-combat)] p-4 rounded-lg bg-[#21262d] border border-[var(--color-combat)] font-semibold">
                        üö´ No rules found matching your search query. Try different keywords.
                    </div>
                </div>

                <main id="rulesContainer">
                    </main>
            </div>
            </div>
        <section id="communityFeedback" class="mt-12 p-8 bg-[#161b22] rounded-xl shadow-2xl border border-[#444c56]">
            <h2 class="text-4xl font-extrabold text-white mb-6 border-b border-[#444c56] pb-3 text-center">Community Feedback & Links</h2>
            
            <div class="grid md:grid-cols-2 gap-10">
                
                <div class="space-y-4">
                    <h3 class="text-2xl font-bold text-[var(--text-accent)] border-b border-[#30363d] pb-2">Essential Links</h3>
                    
                    <a href="https://discord.gg/unitingkingdomsrp" target="_blank" 
                       class="flex items-center p-4 bg-[#21262d] hover:bg-[#30363d] rounded-lg transition duration-150 border border-[#444c56] text-white transform hover:scale-[1.01]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-4 text-[#7289da]" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 10.97c-3.15 0-5.71 2.56-5.71 5.71s2.56 5.71 5.71 5.71c3.15 0 5.71-2.56 5.71-5.71s-2.56-5.71-5.71-5.71zM11.99 2a10.22 10.22 0 0 0-4.07.82 1.42 1.42 0 0 0-.8-.11c-1.28-.42-2.39-.71-2.9-.91A12.75 12.75 0 0 0 .54 8.78c.32 2.76.92 5.37 1.63 7.62a1.88 1.88 0 0 0 1.25 1.15c.57.18 1.16.29 1.74.4 1.49.29 3.01.44 4.51.44s3.02-.15 4.51-.44c.58-.11 1.17-.22 1.74-.4a1.88 1.88 0 0 0 1.25-1.15c.71-2.25 1.31-4.86 1.63-7.62A12.75 12.75 0 0 0 12.55 2c-.18 0-.37 0-.56 0zm-2.6 12.87c.21.21.48.31.76.31h.7c.28 0 .55-.1.76-.31a2.84 2.84 0 0 0 1.94-2.58c0-1.47-1.19-2.66-2.66-2.66s-2.66 1.19-2.66 2.66c0 1.05.61 1.97 1.57 2.4z"/>
                        </svg>
                        <span class="font-bold text-lg">Join Our Discord</span>
                    </a>

                    <a href="https://discord.com/channels/870567426306211840/870567426922799104/1441150822455971960" target="_blank" 
                       class="flex items-center p-4 bg-[#21262d] hover:bg-[#30363d] rounded-lg transition duration-150 border border-[#444c56] text-white transform hover:scale-[1.01]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-4 text-[var(--color-whitelist)]" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-3 10a1 1 0 011-1h4a1 1 0 110 2h-4a1 1 0 01-1-1zm0 4a1 1 0 011-1h4a1 1 0 110 2h-4a1 1 0 01-1-1z"/>
                        </svg>
                        <span class="font-bold text-lg">Whitelist Application</span>
                    </a>
                    
                    <a href="https://unitingkingdomsrp.co.uk/" target="_blank" 
                       class="flex items-center p-4 bg-[#21262d] hover:bg-[#30363d] rounded-lg transition duration-150 border border-[#444c56] text-white transform hover:scale-[1.01]">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-4 text-[var(--color-crime)]" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 15.93c-2.45-.37-4.2-1.85-4.2-4.13 0-2.34 2.16-4.14 5.31-4.14 2.79 0 4.88 1.48 4.88 3.73 0 2.3-2.19 3.86-5.18 3.86-.87 0-1.66-.14-2.36-.36zm-1.8-6.1c-.6-.2-1.1-.3-1.6-.3s-.9.1-1.3.3c-.4.2-.7.5-.9.9s-.3.8-.3 1.3c0 .5.1.9.3 1.3s.7.7 1.3.9c.6.2 1.1.3 1.6.3s1-.1 1.5-.3c.5-.2.9-.5 1.1-.9s-.3-.9-.3-1.4c0-.6-.2-1.1-.6-1.5s-.8-.7-1.4-.9z"/>
                        </svg>
                        <span class="font-bold text-lg">Official Website</span>
                    </a>
                </div>

                <div class="space-y-4">
                    <h3 class="text-2xl font-bold text-[var(--color-whitelist)] border-b border-[#30363d] pb-2">Leave a Server Review</h3>
                    <p class="text-sm text-[#8b949e]">Share your thoughts on the UKRP experience. **Note:** Using the '@' symbol or profanity in the review is strictly forbidden and will block submission.</p>
                    
                    <form id="reviewForm" class="space-y-4">
                        
                        <div>
                            <label class="block text-sm font-medium text-white mb-1">Your Rating (1-5 Stars)</label>
                            <div class="rating-group">
                                <input type="radio" id="star5" name="rating" value="5" class="hidden" required>
                                <label for="star5" title="5 Stars">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" stroke="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2.628l2.96 6.007 6.64.966-4.8 4.676 1.13 6.62-5.93-3.11-5.93 3.11 1.13-6.62-4.8-4.676 6.64-.966L12 2.628z"/>
                                    </svg>
                                </label>
                                <input type="radio" id="star4" name="rating" value="4" class="hidden">
                                <label for="star4" title="4 Stars">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" stroke="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2.628l2.96 6.007 6.64.966-4.8 4.676 1.13 6.62-5.93-3.11-5.93 3.11 1.13-6.62-4.8-4.676 6.64-.966L12 2.628z"/>
                                    </svg>
                                </label>
                                <input type="radio" id="star3" name="rating" value="3" class="hidden">
                                <label for="star3" title="3 Stars">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" stroke="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2.628l2.96 6.007 6.64.966-4.8 4.676 1.13 6.62-5.93-3.11-5.93 3.11 1.13-6.62-4.8-4.676 6.64-.966L12 2.628z"/>
                                    </svg>
                                </label>
                                <input type="radio" id="star2" name="rating" value="2" class="hidden">
                                <label for="star2" title="2 Stars">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" stroke="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2.628l2.96 6.007 6.64.966-4.8 4.676 1.13 6.62-5.93-3.11-5.93 3.11 1.13-6.62-4.8-4.676 6.64-.966L12 2.628z"/>
                                    </svg>
                                </label>
                                <input type="radio" id="star1" name="rating" value="1" class="hidden">
                                <label for="star1" title="1 Star">
                                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor" stroke="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2.628l2.96 6.007 6.64.966-4.8 4.676 1.13 6.62-5.93-3.11-5.93 3.11 1.13-6.62-4.8-4.676 6.64-.966L12 2.628z"/>
                                    </svg>
                                </label>
                            </div>
                        </div>

                        <div>
                            <label for="reviewerName" class="block text-sm font-medium text-white mb-1">Your In-Game Name (Optional)</label>
                            <input type="text" id="reviewerName" maxlength="32"
                                   class="w-full p-3 rounded-md bg-[#21262d] text-white border border-[#444c56] focus:ring-[var(--color-whitelist)] focus:border-[var(--color-whitelist)] transition duration-150">
                        </div>
                        
                        <div>
                            <label for="reviewContent" class="block text-sm font-medium text-white mb-1">Your Review (Max 500 characters)</label>
                            <textarea id="reviewContent" rows="4" maxlength="500" required
                                      class="w-full p-3 rounded-md bg-[#21262d] text-white border border-[#444c56] focus:ring-[var(--color-whitelist)] focus:border-[var(--color-whitelist)] transition duration-150 resize-none"
                                      placeholder="I love the realistic UK environment and the serious RP rules..."></textarea>
                        </div>
                        
                        <div id="messageBox" class="p-3 text-sm rounded-lg font-bold hidden" role="alert"></div>
                        
                        <button type="submit" id="submitReviewBtn"
                                class="w-full py-3 px-4 bg-[var(--color-whitelist)] hover:bg-[#d49e00] text-black font-extrabold rounded-lg shadow-lg transition duration-200 transform hover:scale-[1.01]">
                            Submit Review
                        </button>
                    </form>
                </div>
            </div>
        </section>


        <footer class="mt-12 pt-6 border-t border-[#444c56] text-center text-sm text-[#8b949e]">
            &copy; UKRP Community Guide. Organized for clarity and ease of access.
        </footer>
    </div>

    <script>
        // Data structure derived directly from UKRP_Categorized_Rules.md
        const rulesData = [
            {
                id: 'section1',
                title: "Section 1: General Server Rules & OOC Conduct",
                color: 'var(--color-general)',
                description: "This section covers rules regarding player behavior, staff interaction, and anything that is not considered 'In Character' (IC) roleplay.",
                rules: [
                    { topic: "Server Authority & Common Sense", original: "1.0, 1.5, 1.8", summary: "Staff have the final say on all rulings. Report staff issues on Discord. Use common sense; if you think something is questionable, it probably is." },
                    { topic: "Respect & Toxicity", original: "1.0, 1.5", summary: "Respect all players (IC and OOC). No OOC drama, toxicity, or personal attacks. Directed bigoted language or slurs will result in an immediate and severe ban." },
                    { topic: "Reporting & Admin Situations", original: "1.6, 1.7", summary: "Use /report for in-game issues. Wait until the RP is completely over to report. Do not interrupt staff situations. All reports require clear evidence. Do not abuse the system to regain lost items." },
                    { topic: "Server/Player Requirements", original: "1.2, 1.3, 1.9.2, 7.8", summary: "A working microphone is required. Must understand and speak English. Offensive or derogatory character names are not allowed. Character deletion is your own responsibility; create a ticket if you wish to keep any items." },
                    { topic: "Exploitation & Monetization", original: "1.9.3, 1.9.4", summary: "Exploiting bugs/glitches, using external crosshairs, or lag-switching is forbidden. All bugs must be reported immediately. The transfer of real-world money or goods for in-game assets is permanently forbidden." },
                    { topic: "Miscellaneous OOC", original: "1.9.1, 7.7", summary: "No non-authorized advertising. Leaking private information from the Discord or UKRP is strictly forbidden." },
                    { topic: "Transfer & Gifting Limit", original: "NEW 1.10", summary: "**Excessive Gifting/Transfer** is forbidden. The maximum amount of money or items a player can transfer to another player outside of a legitimate IC purchase or wage payment is **¬£20,000 gift per day** to prevent illicit fund movement."},
                ]
            },
            {
                id: 'section2',
                title: "Section 2: Whitelist & Character Rules",
                color: 'var(--color-whitelist)',
                description: "This section focuses on the requirements and status of your character on the server.",
                rules: [
                    { topic: "Whitelist Application", original: "1, 2", summary: "The first application is reviewed leniently, the second is stricter. You must apply via the dedicated Discord link and demonstrate an understanding of all server rules." },
                    { topic: "Whitelist Activity", original: "3, 4.6", summary: "Whitelisted players must maintain an average of at least 5 hours of playtime per week. You must maintain an average of 7 hours per week for your specific whitelisted job/role. Only one whitelisted job/role is permitted per person." },
                    { topic: "Character & Appearance", original: "2.1", summary: "Character names and clothing must be realistic and appropriate for the UK setting. Unsuitable names may force a character recreation." },
                ]
            },
            {
                id: 'section3',
                title: "Section 3: Core Roleplay (IC) Mechanics",
                color: 'var(--color-core-rp)',
                description: "This section outlines the rules necessary to maintain a realistic and fair roleplaying environment.",
                rules: [
                    { topic: "Maintaining Character (IC/OOC)", original: "1.1, 3.3", summary: "You must remain In-Character (IC) at all times while in the server. OOC should only be initiated by a moderator. Do not break character by discussing real life, lag, or server rules in-game." },
                    { topic: "Metagaming", original: "1.4, 4.5", summary: "Do not use out-of-character knowledge (e.g., streams, Discord, OOC chat) for IC gain. If you are in a Discord/VOIP call during active RP, you must deafen or disconnect." },
                    { topic: "Valuing Life (FTVL)", original: "3.2", summary: "You must value your life and comply with demands if clearly outnumbered, cornered, or at a significant disadvantage." },
                    { topic: "New Life Rule (NLR)", original: "3.1", summary: "After death, you cannot remember your previous life (who killed you, where you died). You cannot return to the place of death until the RP scene is over. NLR is nullified only if revived by a Witch Doctor or NHS personnel." },
                    { topic: "FailRP & Realism", original: "2.7, 2.8, 2.5", summary: "Do not do things you cannot do in real life (FailRP). Interfering with police/NHS scenes without a valid IC reason is FailRP. Excessive and unrealistic 'GTA Driving' must be roleplayed as causing injuries." },
                    { topic: "Power-Gaming", original: "2.5", summary: "Spam punching, cancelling animations, or using unrealistic mechanics (e.g., 'sunbathing' through doors to look inside) is forbidden." },
                    { topic: "Combat-Logging", original: "1.9, 3.4", summary: "F8 Quitting or disconnecting during an active RP scene or staff interaction will result in a ban." },
                    { topic: "Extreme RP", original: "2.0, 2.2", summary: "**Suicide RP is permanent character death** (the character will be deleted). Any type of forced sexual (Erotic) RP is strictly forbidden and will result in a permanent ban." },
                    { topic: "Voice/Mic Clarity", original: "NEW 3.10", summary: "Players are responsible for ensuring their voice is clearly audible. If a threat or demand is not clearly heard by the other party due to mic quality or low volume, the RP interaction may be voided by a moderator." },
                ]
            },
            {
                id: 'section4',
                title: "Section 4: Combat & Killing Rules",
                color: 'var(--color-combat)',
                description: "This section details all rules related to physical aggression, death, and use of force.",
                rules: [
                    { topic: "Initiation & Reason", original: "2.3, 2.3.1", summary: "**Random Deathmatch (RDM) is forbidden.** When attacking, you must have both clear **initiation** and a clear **reason**. One-or-no-sentence killings are considered RDM." },
                    { topic: "Vehicle Use in Combat (VDM)", original: "2.4", summary: "**Vehicle Deathmatch (VDM) is forbidden.** Any purposely aggressive action involving hitting or running over other players with a vehicle is VDM." },
                    { topic: "Death Animation", original: "0.1", summary: "If your character dies, you must press 'E' immediately to re-enter the death animation. **Do not hold 'E' to respawn**; this is FailRP." },
                    { topic: "Drive-Bys & Weapons", original: "3.2.3.1, 2.7.1", summary: "Do not shoot from the driver's seat (motorcycles allowed). Do not shoot out of any vehicle unless the windows are down. **Hunting Rifles are for animals only** and cannot be used against players (PERM BAN)." },
                    { topic: "Spawn/New Player Protection", original: "3.9", summary: "It is forbidden to rob, kidnap, or kill new players at the character creation or hospital spawn locations. Camping spawn locations is also forbidden." },
                ]
            },
            {
                id: 'section5',
                title: "Section 5: Criminal & Law Enforcement Rules",
                color: 'var(--color-crime)',
                description: "Rules specific to illegal activities and interactions with Police (MPS), NHS, and government factions.",
                rules: [
                    { topic: "Crime Timers & Restarts", original: "5.1", summary: "No illegal activity 30 minutes before and 15 minutes after a server restart (for major crime like banks). No murder/robbery/drug selling 15 minutes before and 15 minutes after restart." },
                    { topic: "Robbery & Hostage Limits", original: "4.9, 5.5", summary: "Max **4 robbers** in a standard bank. Max **6 robbers** in Bobcat/Big Bank. Max **2 hostages** are allowed. Maximum hostage time is **30 minutes** (unless actively engaged with police)." },
                    { topic: "Law Enforcement Interaction", original: "5.4, 5.6", summary: "You can kidnap police if there is a valid RP reason and more than one officer is online. You are **not** to initiate hostile RP towards the NHS (retaliation is allowed if they are hostile)." },
                    { topic: "Custody & Escape", original: "4.4", summary: "After treatment/arrest, you are considered to be in NHS or MPS custody until you are officially cleared or have successfully escaped." },
                    { topic: "Kidnapping & Financial Limits", original: "5.3, 3.5", summary: "You can only kidnap the same person/group once every **2 hours**. It is forbidden to force people to transfer money or vehicles (including bank transfers)." },
                    { topic: "Criminal Theft & Contraband", original: "3.2.4, 6.1, 5.9", summary: "Do not steal police-issued heavy weapons or heavy ammo. You can /me take an officer's non-heavy weapon, GPS, armor, handcuffs, and cuff keys. It is forbidden to rob any food or drinks from players." },
                    { topic: "Raids & Evidence", original: "1.9.5, 1.9.6, 4.3", summary: "If raided while home, you must give police your house keys when cuffed. You must wait for the player to join the server before robbing/raiding their property. Do not take anything from police evidence (1 month whitelist ban)." },
                    { topic: "Corruption & Special Rules", original: "5.7, 5.8, 6.2", summary: "You cannot be part of a criminal gang and CID simultaneously. Corrupt cop RP is limited to overlooking items in a search. Terrorism/Bomb RP is not allowed unless cleared by a senior admin." },
                    { topic: "Hostage Execution", original: "NEW 5.10", summary: "**CRITICAL RULE:** Hostages should **never** be executed by criminals unless the hostage deliberately violates a direct, realistic command given during the situation. Killing a hostage to punish the police for non-compliance is bad faith RP." },
                    { topic: "Baiting Police", original: "NEW 5.11", summary: "Creating an excessive, prolonged police chase/situation with no clear IC goal (e.g., escaping, robbing) solely for OOC entertainment is classed as FailRP or Non-Valued RP." },
                    { topic: "Downed Status", original: "NEW 5.12", summary: "When an MPS or NHS member is downed (critical condition), they **cannot** use their radio, phone, or mic to transmit information until revived/treated." },
                ]
            },
            {
                id: 'section6',
                title: "Section 6: Businesses, Property & Economy",
                color: 'var(--color-economy)',
                description: "This section covers rules for whitelisted businesses, real estate, and financial transactions.",
                rules: [
                    { topic: "Business Operations", original: "4.7, 4.8", summary: "Business owners are responsible for paying employee wages and ensuring employees follow rules. Businesses (e.g., mechanics) must prioritize providing their service over other activities (e.g., crime)." },
                    { topic: "Sales & Scamming", original: "1.9.8, 6.6", summary: "Shop items cannot be priced more than **triple** the item's purchase price (shop removal if reported). Scamming for vehicles is not permitted. You may only scam players for illegal items (weapons, heist gear) with a maximum value of **¬£500,000**." },
                    { topic: "Real Estate", original: "7.4, 7.5", summary: "Real estate must not conduct business or sell properties on Cayo Perico Island. Real estate agents must stick to the agreed-upon value (upselling percentage is disclosed to agents)." },
                    { topic: "Vehicle Use", original: "3.2.3", summary: "Redline Showroom Nitro Cars cannot be used for criminal elements; they are for racing/city driving only. They should be transported via trailers." },
                    { topic: "Forceful Vehicle Theft RP", original: "NEW 6.7", summary: "Criminals must perform a minimum of **2-3 lines of roleplay interaction** (e.g., '/me hotwires the ignition') to successfully steal keys or hotwire a vehicle from an incapacitated or compliant owner." },
                ]
            },
            {
                id: 'section7',
                title: "Section 7: Zone & Vehicle Placement Rules",
                color: 'var(--color-zones)',
                description: "This section outlines rules for specific locations, including 'Green Zones' where hostile RP is restricted.",
                rules: [
                    { topic: "Designated Green Zones", original: "6.4, 6.5", summary: "Hospitals, Job Centre, Mechanic Shop, Real Estate Office, Police Impound, Trucking Building, Underground Racing Zone, and Character Creation Spawn." },
                    { topic: "Green Zone Conduct", original: "6.4, 6.5", summary: "Hostile RP or combat must **not** be initiated inside these areas. If active RP enters a Green Zone, the RP may continue, but the rule-breaker may still be reported. Camping inside is forbidden." },
                    { topic: "Vehicle Placement", original: "5.2", summary: "Vehicles are not allowed inside buildings. No meth cooking underground or in railway tunnels." },
                    { topic: "Restricted Areas", original: "3.8", summary: "Impersonating the NHS or entering the military base/aircraft carrier (unless for business deliveries) is forbidden." },
                    { topic: "Car Chase Player Limit", original: "NEW 7.6", summary: "Limit the maximum number of **criminal vehicles** allowed to chase or follow police in a single, non-heist situation to **max 3 cars** to maintain realism and server performance." },
                ]
            },
            {
                id: 'section8',
                title: "Section 8: Aircraft Rules",
                color: 'var(--color-aircraft)',
                description: "Specific rules for the use of planes and helicopters. The Restricted Flying Zone map is shown below.",
                imageUrl: "https://i.gyazo.com/fad0f3f014c5988a6ac3218d7409e33f.png",
                rules: [
                    { topic: "General Flying", original: "7.0, 7.1", summary: "You must not deliberately collide with aircraft, people, or buildings. You must fly realistically (no flying under bridges or close to buildings). You must value your life in an aircraft." },
                    { topic: "Aircraft Storage", original: "7.2", summary: "You may only store aircraft in aircraft garages. Do not use the impound feature to bring out aircraft or boats at car garages." },
                    { topic: "Flying Zones", original: "7.3", summary: "**Planes and Helicopters** must not be flown/landed in the zones marked red and blue (except on helipads/runways). **Helicopters** must not be flown in the zones marked blue. Landing must be realistic (no landing on streets/garages/houses, except for NHS and Police). **See Map Below for Visual Reference.**" },
                    { topic: "Theft", original: "4.2", summary: "You are allowed to steal aircraft, but military vehicles are forbidden." },
                ]
            },
            /* ADDED NEW SECTION FOR DISCORD RULES */
            {
                id: 'section9',
                title: "Section 9: Discord & Community Rules",
                color: 'var(--color-general)', // Reusing General color for consistency
                description: "Rules for appropriate conduct and general interactions within the UKRP Discord server.",
                rules: [
                    { topic: "General Etiquette", original: "D.1", summary: "Be respectful and civil towards all community members and staff. Do not spam or misuse channels. Follow channel-specific rules." },
                    { topic: "Off-Topic/Support", original: "D.2", summary: "Keep discussions in appropriate channels. Use the designated support channels or tickets for admin help, reports, or general questions." },
                    { topic: "NSFW & Sensitive Content", original: "D.3", summary: "No Not-Safe-For-Work (NSFW) content, Gore, or extreme political discussion is permitted. Keep profanity to a minimum." },
                    { topic: "Harassment & Personal Attacks", original: "D.4", summary: "Harassment, personal insults, or directed toxicity towards any member will result in a ban. Do not share private information (Doxxing)." },
                    { topic: "Mentions & Pings", original: "D.5", summary: "Do not excessively or needlessly 'ping' or 'mention' staff members, mods, or large roles. Only tag staff if an issue requires immediate attention (e.g., an in-game combat situation)." },
                    { topic: "Advertising", original: "D.6", summary: "No external advertising for other servers, businesses, or personal services without explicit staff permission." },
                ]
            }
        ];

        // --- CUSTOM REVIEW LOGIC ---
        const WEBHOOK_URL = "https://discord.com/api/webhooks/1442999476695601154/MCOqBUHWV2gFfPNU8-6xBgCS2zLA2shWINniaXtz6HYzuU4xLyQEbGjEywBbjiL8QuM0";
        
        // Expanded list of profanity and sensitive terms for moderation
        const SWEAR_WORDS = [
            "asshole", "bitch", "crap", "cunt", "damn", "dick", "fag", "fuck", 
            "hell", "nigger", "piss", "shit", "slut", "tits", "wank", "bollocks", 
            "prick", "cock", "spastic", "retard", "minger", "knob", "twat"
        ];
        
        // Helper function to show messages
        function showMessage(text, className) {
            const messageBox = document.getElementById('messageBox');
            messageBox.textContent = text;
            messageBox.className = `${className} p-3 text-sm rounded-lg font-bold block`;
        }

        async function submitReview(event) {
            event.preventDefault();

            const nameInput = document.getElementById('reviewerName');
            const contentInput = document.getElementById('reviewContent');
            const ratingInput = document.querySelector('input[name="rating"]:checked');
            const messageBox = document.getElementById('messageBox');
            const submitBtn = document.getElementById('submitReviewBtn');
            
            // Clear previous messages
            messageBox.textContent = '';
            messageBox.className = 'p-3 text-sm rounded-lg font-bold hidden';
            submitBtn.disabled = true;

            const name = nameInput.value.trim();
            const content = contentInput.value.trim();
            const rating = ratingInput ? parseInt(ratingInput.value) : null;
            const stars = rating ? '‚≠ê'.repeat(rating) : '';

            // 1. Validation Checks
            if (!rating) {
                showMessage('Please select a star rating.', 'bg-red-900 text-red-300');
                submitBtn.disabled = false;
                return;
            }

            if (content.length < 10) {
                showMessage('Please write a slightly longer review (min 10 characters).', 'bg-red-900 text-red-300');
                submitBtn.disabled = false;
                return;
            }

            // 1.1 Check for banned characters (@, #)
            const inputCheck = name + " " + content;
            if (inputCheck.includes('#') || inputCheck.includes('@')) {
                showMessage('The use of "#" or "@" is strictly forbidden in the review or name fields.', 'bg-red-900 text-red-300');
                submitBtn.disabled = false;
                return;
            }

            // 1.2 Check for swear words (case-insensitive)
            const textToCheck = inputCheck.toLowerCase();
            const foundSwear = SWEAR_WORDS.some(word => 
                // Using regex to match whole words to reduce false positives
                new RegExp(`\\b${word}\\b`, 'i').test(textToCheck)
            );

            if (foundSwear) {
                showMessage('Your review contains restricted language or profanity. Please revise the content.', 'bg-red-900 text-red-300');
                submitBtn.disabled = false;
                return;
            }

            // Construct Discord Payload
            const payload = {
                username: "UKRP Website Review Bot",
                avatar_url: "https://unitingkingdomsrp.co.uk/logo_1.png",
                embeds: [{
                    // Include the stars in the title for emphasis
                    title: `üåü New Community Review | ${stars} (${rating}/5)`,
                    description: `> ${content}`, // Format content as a blockquote
                    color: 16752640, // Ffa700 (orange/yellow)
                    fields: [
                        {
                            name: "Reviewer Name",
                            value: name || "*Anonymous User*",
                            inline: true
                        },
                        {
                            name: "Rating Score",
                            value: `${rating}/5 Stars`,
                            inline: true
                        },
                        {
                            name: "Source Page",
                            value: "Rules & Reference Guide",
                            inline: false
                        }
                    ],
                    footer: {
                        text: "Thank you for your feedback!"
                    },
                    timestamp: new Date().toISOString()
                }]
            };

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                });

                if (response.ok) {
                    showMessage('‚úÖ Thank you! Your review has been successfully submitted.', 'bg-green-900 text-green-300');
                    // Reset form after successful submission
                    document.getElementById('reviewForm').reset();
                    // Manually uncheck stars for a clean reset
                    if (ratingInput) ratingInput.checked = false; 

                } else {
                    const errorText = await response.text();
                    console.error('Discord Webhook Error:', response.status, errorText);
                    showMessage(`‚ùå Submission failed (Error ${response.status}). Please try again later.`, 'bg-red-900 text-red-300');
                }
            } catch (error) {
                console.error('Fetch Error:', error);
                showMessage('‚ùå An unexpected error occurred. Check your connection or try again.', 'bg-red-900 text-red-300');
            } finally {
                submitBtn.disabled = false;
            }
        }
        
        // --- EXISTING RULES LOGIC (with modifications) ---

        const rulesContainer = document.getElementById('rulesContainer');
        const sideNav = document.getElementById('sideNav');

        // Function to render the rule tables AND the navigation links
        function renderRules(data) {
            rulesContainer.innerHTML = ''; // Clear previous content
            sideNav.innerHTML = '<h3 class="text-xl font-bold text-white mb-4 border-b border-[#444c56] pb-2">Rule Categories</h3>';
            
            const navList = document.createElement('ul');
            navList.className = "space-y-1";
            
            data.forEach(section => {
                // 1. Render Navigation Link
                const navLink = document.createElement('a');
                navLink.href = `#${section.id}`;
                navLink.className = "block p-2 rounded-md text-[var(--text-light)] hover:bg-[#21262d] hover:text-[var(--text-accent)] transition duration-150 text-sm font-medium";
                // Only show the section title in the nav, stripping the "Section X: " part for cleaner look
                navLink.textContent = section.title.split(': ').slice(1).join(': ') || section.title;
                
                // Add smooth scroll behavior
                navLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    // Use a slight offset to account for the sticky header/search bar
                    const targetElement = document.getElementById(section.id);
                    if (targetElement) {
                        const offset = document.getElementById('ruleSearch').offsetHeight + 20; 
                        const bodyRect = document.body.getBoundingClientRect().top;
                        const elementRect = targetElement.getBoundingClientRect().top;
                        const elementPosition = elementRect - bodyRect;
                        const offsetPosition = elementPosition - offset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
                
                const navItem = document.createElement('li');
                navItem.appendChild(navLink);
                navList.appendChild(navItem);


                // 2. Render Rule Content
                let imageHtml = '';
                if (section.imageUrl) {
                    // This logic specifically targets the Aircraft Rules section
                    if (section.id === 'section8') {
                        imageHtml = `
                            <div class="mt-6 mb-4 p-4 bg-[#21262d] rounded-lg border border-[#444c56] text-center">
                                <img src="${section.imageUrl}" alt="${section.title} Map" 
                                     class="w-full h-auto max-h-96 object-contain rounded-md mx-auto border-2 border-[var(--color-aircraft)] shadow-lg">
                                <p class="mt-3 text-sm text-[var(--color-aircraft)] font-semibold">Visual Reference: Restricted Flying Zones (The red area indicates no-fly/no-land zones)</p>
                            </div>
                        `;
                    }
                }

                // Apply dynamic accent color to the section header style
                const sectionHtml = `
                    <section id="${section.id}" class="mb-10 p-6 rule-section rounded-xl border border-[#444c56]" style="--accent-color: ${section.color};">
                        <h2 class="text-3xl font-bold mb-4 section-header text-white">${section.title}</h2>
                        <p class="text-[#8b949e] mb-4">${section.description}</p>
                        ${imageHtml} <table class="w-full rule-table rounded-xl overflow-hidden">
                            <thead>
                                <tr class="bg-[#1f242c]">
                                    <th class="w-1/4">Topic</th>
                                    <th class="w-1/12">Rule #</th>
                                    <th class="w-2/3">Summary of Rules</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${section.rules.map(rule => {
                                    const isNewRule = rule.original.startsWith('NEW');
                                    const rowClass = isNewRule ? 'rule-item rule-new' : 'rule-item';
                                    const topicTextClass = isNewRule ? 'text-[var(--color-crime)]' : 'text-white'; // Highlight new topic text
                                    return `
                                        <tr class="${rowClass}" data-search="${(rule.topic + rule.original + rule.summary).toLowerCase()}">
                                            <td class="font-bold ${topicTextClass}">${rule.topic}</td>
                                            <td class="text-sm text-[var(--text-accent)] font-mono">${rule.original}</td>
                                            <td>${rule.summary}</td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </section>
                `;
                rulesContainer.insertAdjacentHTML('beforeend', sectionHtml);
            });
            
            sideNav.appendChild(navList);
            
            // --- ADDED STATIC LINK FOR FEEDBACK (Start) ---
            const feedbackLink = document.createElement('a');
            feedbackLink.href = `#communityFeedback`; 
            feedbackLink.className = "block p-3 mt-6 rounded-lg text-black font-extrabold bg-[var(--color-whitelist)] hover:bg-[#d49e00] transition duration-150 text-base shadow-md";
            feedbackLink.textContent = "Community Feedback & Links üöÄ";
            
            // Add custom scroll logic for the static link
            feedbackLink.addEventListener('click', (e) => {
                e.preventDefault();
                const targetElement = document.getElementById('communityFeedback');
                if (targetElement) {
                    const offset = document.getElementById('ruleSearch').offsetHeight + 20; 
                    const bodyRect = document.body.getBoundingClientRect().top;
                    const elementRect = targetElement.getBoundingClientRect().top;
                    const elementPosition = elementRect - bodyRect;
                    const offsetPosition = elementPosition - offset;

                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });

            sideNav.appendChild(feedbackLink);
            // --- ADDED STATIC LINK FOR FEEDBACK (End) ---
        }

        // Search and Filtering Logic
        window.onload = () => {
            renderRules(rulesData);
            
            // --- Attach Review Form Listener ---
            document.getElementById('reviewForm').addEventListener('submit', submitReview);
            // -----------------------------------

            const searchInput = document.getElementById('ruleSearch');
            const clearButton = document.getElementById('clearSearch');
            const noResultsDiv = document.getElementById('noResults');
            const sections = document.querySelectorAll('main#rulesContainer section');
            
            // Function to filter rules based on search input
            function filterRules() {
                const query = searchInput.value.toLowerCase().trim();
                let visibleRuleCount = 0;
                
                // Track which sections still have visible rules
                const sectionVisibility = {};
                rulesData.forEach(section => sectionVisibility[section.id] = false);

                // Toggle Clear Button Visibility
                clearButton.style.display = query ? 'block' : 'none';

                document.querySelectorAll('.rule-item').forEach(item => { // Re-select items after rendering to ensure freshness
                    const searchData = item.getAttribute('data-search');
                    // Match if query is empty OR data includes query
                    const isMatch = !query || searchData.includes(query);
                    
                    // Toggle rule visibility
                    item.style.display = isMatch ? '' : 'none';

                    // If a rule matches, count it and mark its section as visible
                    if (isMatch) {
                        visibleRuleCount++;
                        const section = item.closest('section');
                        if (section) {
                            sectionVisibility[section.id] = true;
                        }
                    }
                });

                // Toggle Section Visibility
                sections.forEach(sectionElement => {
                    const sectionId = sectionElement.id;
                    
                    const isVisible = sectionVisibility[sectionId];
                    sectionElement.style.display = isVisible ? 'block' : 'none';
                    
                    // Also update side nav link style based on visibility (only relevant when searching)
                    const navLink = sideNav.querySelector(`a[href="#${sectionId}"]`);
                    if (navLink) {
                         if (query) {
                             // During search, highlight only visible categories
                             navLink.classList.toggle('opacity-100', isVisible);
                             navLink.classList.toggle('opacity-30', !isVisible);
                         } else {
                             // Reset opacity when search is empty
                             navLink.classList.remove('opacity-30');
                             navLink.classList.add('opacity-100');
                         }
                    }
                });

                // Toggle "No Results" message only if there is an active query
                noResultsDiv.style.display = (visibleRuleCount === 0 && query) ? 'block' : 'none';
            }
            
            // Attach listeners
            searchInput.addEventListener('input', filterRules);
            
            clearButton.addEventListener('click', () => {
                searchInput.value = '';
                filterRules(); // Re-run filter to show all
                searchInput.focus(); // Keep focus for user
            });

            // Initial call to set up the clear button state
            filterRules();
        };
    </script>

</body>
</html>
```