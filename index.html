<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UKRP Rules & Reference Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Define refined accent colors for visual distinction */
            --color-general: #3B82F6; /* Primary Blue Accent (Tailwind blue-500) */
            --color-highlight: #00BFFF; /* Secondary Bright Blue Highlight */
            
            --color-whitelist: #FFC107; /* Gold/Warning */
            --color-core-rp: #34D399; /* Light Green for Core RP */
            --color-combat: #E74C3C; /* Danger Red */
            --color-crime: #B03A2E; /* Deep Red/Maroon */
            --color-economy: #10B981; /* Emerald Green */
            --color-zones: #F39C12; /* Orange */
            --color-aircraft: #BDC3C7; /* Light Gray */
            --color-discord: #5865F2; /* Discord Blurple */
            
            --color-new-rule: rgba(59, 130, 246, 0.15); /* Soft Blue tint for new rules */

            /* Theme Base Colors (kept clean and modern) */
            --color-background: #111827; /* Dark Grey/Blue (Tailwind's slate-900) */
            --color-text-primary: #f9fafb; /* Light Grey (Tailwind's gray-50) */
            --color-card-bg: #1f2937; /* Darker Card BG (Tailwind's gray-800) */
            --color-border: #374151; /* Subtle Border (Tailwind's gray-700) */
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-background);
            color: var(--color-text-primary);
        }

        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-background);
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        /* Rule Card styling */
        .rule-card {
            background-color: var(--color-card-bg);
            border-left: 5px solid var(--color-general); /* Now Blue */
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            position: relative; /* For admin buttons positioning */
        }

        .rule-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Category-specific border colors */
        .general-rule { border-left-color: var(--color-general); }
        .whitelist-rule { border-left-color: var(--color-whitelist); }
        .core-rp-rule { border-left-color: var(--color-core-rp); }
        .combat-rule { border-left-color: var(--color-combat); }
        .crime-rule { border-left-color: var(--color-crime); }
        .economy-rule { border-left-color: var(--color-economy); }
        .zones-rule { border-left-color: var(--color-zones); }
        .aircraft-rule { border-left-color: var(--color-aircraft); }
        .discord-rule { border-left-color: var(--color-discord); }
        .new-rule-tag { background-color: var(--color-new-rule); border: 1px solid var(--color-general); } /* Blue Border */

        /* Star rating system */
        .rating-star {
            cursor: pointer;
            font-size: 1.5rem;
            color: #4b5563; /* Default grey color */
            transition: color 0.1s ease-in-out;
        }
        
        .rating-star.selected,
        .rating-star.hover-active {
            color: #FFC107; /* Gold color */
        }

        /* Utility for focusing search */
        .search-focused {
            border-color: var(--color-general) !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5); /* Custom blue ring */
        }

        /* Back to top button style */
        #backToTopBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 99;
            background-color: var(--color-general); /* Now Blue */
            transition: opacity 0.3s, transform 0.3s;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }

        /* Category Button Colors for visual distinction */
        .btn-general { background-color: #3B82F6; border-color: #2563EB; } /* New Blue */
        .btn-whitelist { background-color: #FFC107; color: #111827; border-color: #E0A800; }
        .btn-core-rp { background-color: #34D399; color: #111827; border-color: #2CB380; } /* Adjusted to Green */
        .btn-combat { background-color: #E74C3C; border-color: #C0392B; }
        .btn-crime { background-color: #B03A2E; border-color: #943026; }
        .btn-economy { background-color: #10B981; border-color: #0C9A6A; } /* Adjusted to Emerald Green */
        .btn-zones { background-color: #F39C12; color: #111827; border-color: #D68910; }
        .btn-aircraft { background-color: #BDC3C7; color: #111827; border-color: #A9B3B8; }
        .btn-discord { background-color: #5865F2; border-color: #4752C4; } /* Discord Brand Color */
        
        .btn-all { background-color: #374151; }

        .category-btn {
            transition: all 0.15s ease-in-out;
        }
        
        .category-btn:not(.active):hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .category-btn.active {
            box-shadow: 0 0 0 3px var(--color-general); /* Now Blue */
            opacity: 0.9;
        }

        /* Admin Styles */
        .admin-controls {
            display: none; /* Hidden by default */
        }
        .admin-controls.active {
            display: flex;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }

        .modal.open {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            transform: scale(0.95);
            transition: transform 0.2s ease-in-out;
        }
        .modal.open .modal-content {
            transform: scale(1);
        }

    </style>
</head>
<body>

    <header class="sticky top-0 z-50 bg-gray-900 shadow-xl border-b border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
                <h1 class="text-3xl font-extrabold text-white tracking-tight flex items-center">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-500">UKRP</span>&nbsp;Rules
                </h1>
                
                <div class="relative w-full md:w-80">
                    <input type="text" id="searchInput" placeholder="Search rules..." 
                        class="w-full pl-10 pr-10 py-2 rounded-lg bg-gray-800 text-white border-2 border-gray-700 focus:outline-none focus:border-blue-500 transition duration-150"
                        onfocus="this.classList.add('search-focused')" onblur="this.classList.remove('search-focused')">
                    <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    <button id="clearSearchBtn" class="absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 text-gray-400 hover:text-red-400 transition duration-150 hidden">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                </div>

                <nav class="flex items-center space-x-4">
                    <a href="#rules" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition duration-150 hidden md:block">Rules</a>
                    <a href="#communityFeedback" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition duration-150 hidden md:block">Feedback</a>
                    
                    <button id="adminLoginBtn" onclick="openLoginModal()" class="text-gray-400 hover:text-white px-3 py-2 rounded-md text-sm font-medium border border-gray-700 hover:border-gray-500 transition">
                        Staff Login
                    </button>
                    <div id="adminPanel" class="hidden items-center space-x-2">
                        <button onclick="openRuleModal()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-md text-sm font-bold shadow-md transition flex items-center">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                            Add Rule
                        </button>
                        <button onclick="logout()" class="bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-md text-sm font-bold shadow-md transition">
                            Logout
                        </button>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <section id="communityFeedback" class="mb-12 p-6 bg-gray-800 rounded-xl shadow-2xl border-2 border-blue-500">
            <h2 class="text-3xl font-bold text-center mb-6 text-blue-400">Community Feedback & Links</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                <a href="https://discord.gg/UNITINGKINGDOMSRP" target="_blank" class="flex items-center justify-center p-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition duration-300 shadow-md transform hover:scale-[1.02]">
                    <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M12 10.98C8.98 10.98 6.5 8.5 6.5 5.48c0-3.02 2.48-5.5 5.5-5.5s5.5 2.48 5.5 5.5c0 3.02-2.48 5.5-5.5 5.5zm-5.5-5.5c0 2.07 1.68 3.75 3.75 3.75s3.75-1.68 3.75-3.75c0-2.07-1.68-3.75-3.75-3.75s-3.75 1.68-3.75 3.75zm13 8.5c-.83 0-1.5-.67-1.5-1.5 0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5c0 .83-.67 1.5-1.5 1.5zm-3.5 1.5h-13c-1.38 0-2.5 1.12-2.5 2.5v.5c0 1.38 1.12 2.5 2.5 2.5h13c1.38 0 2.5-1.12 2.5-2.5v-.5c0-1.38-1.12-2.5-2.5-2.5z"></path></svg>
                    Join our Discord
                </a>
                <a href="https://unitingkingdomsrp.co.uk/" target="_blank" class="flex items-center justify-center p-4 bg-pink-600 hover:bg-pink-700 text-white font-semibold rounded-lg transition duration-300 shadow-md transform hover:scale-[1.02]">
                    <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm-2.448 3.513c2.203 0 3.987 1.784 3.987 3.987s-1.784 3.987-3.987 3.987-3.987-1.784-3.987-3.987 1.784-3.987 3.987-3.987zm9.648 11.236c0 .548-.445.992-.993.992h-11.41a.992.992 0 01-.992-.992v-7.94c0-2.617 2.126-4.743 4.743-4.743h7.659c.548 0 .993.444.993.992v11.724z"></path></svg>
                    Support us on Tebex
                </a>
                <a href="#" onclick="document.getElementById('reviewFormContainer').scrollIntoView({behavior: 'smooth', block: 'start'}); return false;" class="flex items-center justify-center p-4 bg-yellow-600 hover:bg-yellow-700 text-white font-semibold rounded-lg transition duration-300 shadow-md transform hover:scale-[1.02]">
                    <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>
                    Leave a Server Review
                </a>
            </div>

            <div id="reviewFormContainer" class="bg-gray-900 p-6 rounded-xl border border-gray-700">
                <h3 class="text-2xl font-semibold mb-4 text-white">Leave a Server Review Now!</h3>
                <p class="text-gray-400 mb-4">Share your honest feedback on your experience. Reviews are public once approved.</p>
                <form id="reviewForm" onsubmit="submitReview(event)">
                    <div class="mb-4">
                        <label for="reviewRating" class="block text-sm font-medium text-gray-300 mb-1">Your Rating</label>
                        <div id="reviewRating" class="flex space-x-1">
                            <span class="rating-star" data-value="1">★</span>
                            <span class="rating-star" data-value="2">★</span>
                            <span class="rating-star" data-value="3">★</span>
                            <span class="rating-star" data-value="4">★</span>
                            <span class="rating-star" data-value="5">★</span>
                        </div>
                        <input type="hidden" id="selectedRating" name="rating" required>
                    </div>
                    <div class="mb-4">
                        <label for="reviewName" class="block text-sm font-medium text-gray-300 mb-1">Your In-Game Name</label>
                        <input type="text" id="reviewName" name="name" required maxlength="50" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="mb-4">
                        <label for="reviewContent" class="block text-sm font-medium text-gray-300 mb-1">Your Review (Max 500 characters)</label>
                        <textarea id="reviewContent" name="content" rows="4" required maxlength="500" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    <div id="reviewMessage" class="mt-4 text-center text-sm font-semibold h-5"></div>
                    <button type="submit" class="w-full py-3 mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg transition duration-300 shadow-lg transform hover:scale-[1.01]">Submit Review</button>
                </form>
            </div>
        </section>

        <section id="categoryFilters" class="mb-12 p-5 bg-gray-800 rounded-xl shadow-xl border-2 border-gray-700">
            <h2 class="text-2xl font-extrabold text-white mb-4 border-b border-gray-700 pb-2">Filter by Category</h2>
            <div id="categoryButtonsContainer" class="flex flex-wrap gap-3 justify-center md:justify-start">
                <button onclick="filterByCategory('All')" data-category="All" class="category-btn active btn-all text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">All Rules</button>
                <button onclick="filterByCategory('General')" data-category="General" class="category-btn btn-general text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">General</button>
                <button onclick="filterByCategory('Whitelist')" data-category="Whitelist" class="category-btn btn-whitelist text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Whitelist</button>
                <button onclick="filterByCategory('Core RP')" data-category="Core RP" class="category-btn btn-core-rp text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Core RP</button>
                <button onclick="filterByCategory('Combat')" data-category="Combat" class="category-btn btn-combat text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Combat</button>
                <button onclick="filterByCategory('Crime')" data-category="Crime" class="category-btn btn-crime text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Crime</button>
                <button onclick="filterByCategory('Economy')" data-category="Economy" class="category-btn btn-economy text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Economy</button>
                <button onclick="filterByCategory('Zones')" data-category="Zones" class="category-btn btn-zones text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Zones</button>
                <button onclick="filterByCategory('Aircraft')" data-category="Aircraft" class="category-btn btn-aircraft text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Aircraft</button>
                <button onclick="filterByCategory('Discord')" data-category="Discord" class="category-btn btn-discord text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-gray-700 transition duration-150">Discord</button>
            </div>
        </section>

        <section id="rules" class="space-y-8">
            <h2 class="text-4xl font-extrabold text-white mb-6 border-b border-gray-700 pb-2">UKRP Rule Book</h2>
            <div id="ruleContainer" class="grid grid-cols-1 gap-6">
                </div>
        </section>

    </main>

    <button id="backToTopBtn" class="p-3 rounded-full shadow-lg text-white hover:bg-blue-700">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
    </button>

    <div id="loginModal" class="modal">
        <div class="modal-content bg-gray-800 p-8 rounded-lg shadow-2xl border border-gray-600 w-96 relative">
            <button onclick="closeModal('loginModal')" class="absolute top-4 right-4 text-gray-400 hover:text-white">✕</button>
            <h2 class="text-2xl font-bold text-white mb-6 text-center">Staff Login</h2>
            <form onsubmit="handleLogin(event)">
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2 text-sm">Username</label>
                    <input type="text" id="adminUser" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="mb-6">
                    <label class="block text-gray-300 mb-2 text-sm">Passcode</label>
                    <input type="password" id="adminPass" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div id="loginError" class="text-red-500 text-sm mb-4 text-center hidden">Invalid credentials</div>
                <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded transition">Login</button>
            </form>
            <p class="text-xs text-gray-500 mt-4 text-center">Default: admin / ukrp2024</p>
        </div>
    </div>

    <div id="ruleModal" class="modal">
        <div class="modal-content bg-gray-800 p-8 rounded-lg shadow-2xl border border-gray-600 w-full max-w-lg relative">
            <button onclick="closeModal('ruleModal')" class="absolute top-4 right-4 text-gray-400 hover:text-white">✕</button>
            <h2 id="modalTitle" class="text-2xl font-bold text-white mb-6">Add New Rule</h2>
            <form onsubmit="handleRuleSubmit(event)">
                <input type="hidden" id="ruleId">
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2 text-sm">Category</label>
                    <select id="ruleCategory" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 outline-none">
                        <option value="General">General</option>
                        <option value="Whitelist">Whitelist</option>
                        <option value="Core RP">Core RP</option>
                        <option value="Combat">Combat</option>
                        <option value="Crime">Crime</option>
                        <option value="Economy">Economy</option>
                        <option value="Zones">Zones</option>
                        <option value="Aircraft">Aircraft</option>
                        <option value="Discord">Discord</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2 text-sm">Rule Title</label>
                    <input type="text" id="ruleTitle" required class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-300 mb-2 text-sm">Description</label>
                    <textarea id="ruleText" required rows="4" class="w-full bg-gray-700 border border-gray-600 rounded p-2 text-white focus:ring-2 focus:ring-blue-500 outline-none"></textarea>
                </div>
                <div class="mb-4 flex items-center">
                    <input type="checkbox" id="ruleNew" class="w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                    <label for="ruleNew" class="ml-2 text-sm text-gray-300">Mark as "NEW"</label>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('ruleModal')" class="bg-gray-600 hover:bg-gray-500 text-white px-4 py-2 rounded">Cancel</button>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-bold">Save Rule</button>
                </div>
            </form>
        </div>
    </div>


    <script>
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1442999476695601154/MCOqBUHWV2gFfPNU8-6xBgCS2zLA2shWINniaXtz6HYzuU4xLyQEbGjEywBbjiL8QuM0';
        let activeCategoryFilter = 'All';
        let isAdmin = false;

        // Default Data (Fallback if localStorage is empty)
        const defaultRulesData = [
             // --- General Rules (1-99) ---
            { id: 1, category: "General", title: "Reporting Violations", text: "All rule breaks must be reported through the designated channels (e.g., in-game reporting, Discord ticket system). Do not attempt to police other players yourself. When making a report/ticket in the discord you must have evidence to back up your claims. Do not discuss player bans or ban reasoning at any point.", tags: ["reporting", "staff", "police", "ticket", "evidence"], new: false },
            { id: 2, category: "General", title: "Respect, Bullying, and Hate Speech", text: "Respect all other players in and out of RP, do not take in-game feuds to real-life. No OOC drama/toxicity. Do not make personal attacks. Use of directed bigoted language, including slurs which degrade another person or group of people based on gender, race, sexual orientation, nationality, religion, disability, etc., can result in any punishment chosen by the responding administrator.", tags: ["respect", "toxicity", "bullying", "hate speech", "slurs"], new: false },
            { id: 3, category: "General", title: "Metagaming & Stream-Sniping (Updated)", text: "The use of any knowledge obtained by means not through in-character interactions (OOC), for gain in-character (IC), or that harms another player or their RP is forbidden. Metagaming includes, but is not limited to, stream-sniping, 'passing' information between your characters, and using information acquired while spectating. If you are in any form of Voice Over IP call like Discord while in an active RP scene, you must deafen to prevent metagaming.", tags: ["metagaming", "streamsniping", "ooc", "ic", "discord", "deafen"], new: true },
            { id: 4, category: "General", title: "Exploiting (Updated)", text: "Exploiting game bugs, server glitches, game mechanics, or out-of-game exploits for personal/group advantage is strictly prohibited and will result in a permanent ban. This includes using software/hardware crosshairs, abusing bugs/glitches, and lag-switching. All bugs and glitches should be reported properly to be fixed.", tags: ["exploit", "bug", "glitch", "hacking", "crosshairs", "ban"], new: true },
            { id: 5, category: "General", title: "Terms of Service", text: "You must adhere to the Discord and FiveM Terms of Service at all times.", tags: ["tos", "fivem", "discord"], new: false },
            { id: 6, category: "General", title: "Admin Situations & Abuse", text: "Do not interrupt staff situations. Abuse of the /report function (e.g., lying to regain lost items) may result in a kick or further punishment. If you have an issue with an RP situation, wait until it is over to report it.", tags: ["staff", "report abuse", "lying", "items"], new: true },
            { id: 7, category: "General", title: "Bad Experiences / Toxicity", text: "If you have an issue with your RP experience, make a ticket and someone will be with you ASAP. Do not be toxic in any way in OOC. Name-calling or posting hate/sarcastic remarks towards the server/community will result in a ban.", tags: ["toxicity", "ooc", "ticket", "hate"], new: true },
            { id: 8, category: "General", title: "Advertising", text: "Non-authorized advertising, including but not limited to other servers, websites, or self-promotion, in the Discord or in-game is not allowed.", tags: ["advertising", "self-promotion"], new: true },
            { id: 9, category: "General", title: "Real-World Monetization (RMT)", text: "Transfer of real-world goods is NOT allowed between players for any purpose. Transferring or attempting to transfer in-game assets (money, vehicles, items) for any out-of-game or real-world money, trade, or services is NOT allowed and will result in both parties being permanently banned.", tags: ["rmt", "real world trade", "ban", "money"], new: true },
            { id: 10, category: "General", title: "Staff Rules", text: "Pending an investigation due to blatant rule breaks, your staff role can be removed. Leaking information from Discord or anything associated with UKRP regarded as private can or will result in a ban or removal from staff.", tags: ["staff", "leaks", "private info"], new: true },
            { id: 11, category: "General", title: "Character Deletion (CHAR DEL)", text: "If you delete your player, the staff holds no responsibility to return any items or cars. You must make a ticket if you wish to delete a player and keep your cars or items.", tags: ["char del", "deletion", "items", "cars"], new: true },
            { id: 12, category: "General", title: "Lawyers", text: "To be confirmed (TBC) rule regarding lawyers.", tags: ["lawyers", "tbc"], new: true },

            // --- Whitelist Rules (100-199) ---
            { id: 101, category: "Whitelist", title: "Whitelist Requirements (Mic/Language)", text: "A successful whitelist application requires a minimum age of 16, a functional microphone, and a basic understanding of roleplay concepts. Players who do not have a working microphone will be kicked. You must understand and speak English.", tags: ["age", "mic", "application", "english"], new: false },
            { id: 102, category: "Whitelist", title: "First Whitelist Application", text: "Your first application will be reviewed leniently, and minor mistakes may be overlooked. However, you are still expected to understand and follow all server rules.", tags: ["application", "lenient", "review"], new: true },
            { id: 103, category: "Whitelist", title: "Second Application Review", text: "If your first application is denied, your second application will be significantly more strict. You will be expected to show a clear understanding of the rules (especially the death-animation rule). Any mistakes may result in another denial.", tags: ["application", "strict", "denial"], new: true },
            { id: 104, category: "Whitelist", title: "Weekly Activity Requirement", text: "All whitelisted players must play at least 5 hours per week. Failure to meet this requirement may result in loss of whitelist status.", tags: ["activity", "time", "loss"], new: true },
            { id: 105, category: "Whitelist", title: "Character Names (Updated)", text: "Character names must be realistic and not include profanity, offensive terms, or famous fictional characters. If the administration team deems any name you are using offensive or derogatory, they reserve the right to adjust or request you change your name. Re-adjusting your name from a suitable name can result in a ban.", tags: ["name", "realism", "offensive", "derogatory"], new: true },
            { id: 106, category: "Whitelist", title: "Job Switching and Activity", text: "If you join a whitelisted job/business, you may not join another whitelisted job for 7 days and you must keep up an average of 7 hours per week per whitelisted job or role. Only one whitelisted job or role can be used per person. LOA (Leave of Absence) can be agreed upon for up to 28 days via a ticket.", tags: ["job", "whitelist", "activity", "loa"], new: true },
            
            // --- Core RP Rules (200-299) ---
            { id: 201, category: "Core RP", title: "FearRP (Failing To Value Life - FTVL)", text: "At all times you are to value your life. You must appropriately value your character's life. Do not engage in risky actions without genuine fear, especially when outnumbered or threatened with weapons. If you are clearly outnumbered or at an obvious disadvantage you should comply with demands. E.g., if held at gunpoint, you should comply.", tags: ["fear", "value of life", "ftvl", "compliance", "gunpoint"], new: false },
            { id: 202, category: "Core RP", title: "Powergaming (Updated & Expanded)", text: "The use of game mechanics to gain an advantage over other players is forbidden. Performing actions that are physically impossible or giving yourself an unfair advantage in RP scenarios without allowing others a chance to react. Examples: Moving seats to get kicked out when cuffed; Cancelling animations; Sunbathing Through A Door (Instant PERM BAN); Pulling A Car Out Of A Garage While In A RP Situation to get away; Talking/Organising/Calling out locations while downed; Escorting people while in vehicles; Government employees not obeying road laws.", tags: ["powergaming", "impossible", "unfair", "/me", "cuff", "animation", "downed", "government"], new: true },
            { id: 203, category: "Core RP", title: "New Life Rule (NLR) (Updated)", text: "Upon respawning or waking up in a hospital, your character forgets the events leading up to their death and cannot remember who killed them or where they died. The previous RP scene needs to be completely forgotten about. You may not return to your place of death until the RP scene is over. You may only remember the previous life if you have been revived by the Witch Doctor or NHS.", tags: ["nlr", "death", "hospital", "timer", "revive"], new: true },
            { id: 204, category: "Core RP", title: "Initiation", text: "You must have verbal or clear non-verbal initiation before engaging in combat or hostile roleplay with another player.", tags: ["initiation", "hostile", "combat", "verbal"], new: false },
            { id: 205, category: "Core RP", title: "Breaking RP (Updated)", text: "You must remain IC at all times while in the server. Breaking character by going OOC should not be happening unless a break-in RP has been initiated by an active member of the moderation team. The only OOC resources players have are Spawn, OOC-chat, and /report. Do not say things like: 'It's lag', 'I'm going to report you', 'That's not allowed your breaking server rules', or 'I don't want to roleplay this'.", tags: ["breaking rp", "ooc", "ic", "moderation"], new: true },
            { id: 206, category: "Core RP", title: "Death Animation", text: "If you die and your player does not do the death animation, or you come out of it for any reason, you are to press 'E' to go back into the animation straight away. Anyone seen not doing this will get one warning before a 7-day ban for failing to RP their death. Do not hold 'E' to respawn and claim it was a mistake.", tags: ["death animation", "fail rp", "respawn"], new: true },
            { id: 207, category: "Core RP", title: "Permanent Character Death (Suicide RP)", text: "Suicide RP: If you choose to commit suicide, that death will be PERMANENT. Your character will be deleted with no return. It is highly advised that you value your lives whilst in-character.", tags: ["pk", "perma-death", "suicide", "deletion"], new: true },
            { id: 208, category: "Core RP", title: "Realism (Character Appearance)", text: "Character clothing must be realistic. Do your best to make sure arms do not show through shirts, etc. If this is an accidental bug please inform administration. If your character name is deemed unsuitable, you may be forced to recreate your character. ", tags: ["realism", "clothing", "bug"], new: true },
            { id: 209, category: "Core RP", title: "Erotic RP", text: "Any type of forced sexual RP is forbidden. Failure to dis-engage sexual RP when requested/told will result in a ban.", tags: ["sexual rp", "forced rp", "erotic"], new: false },
            { id: 210, category: "Core RP", title: "Random Deathmatch (RDM) / Poor RP Killings", text: "RDM is forbidden. Fighting and aggressive actions must be reasoned through RP. When killing someone, you must have both initiation and reason. The reason must be evident within that initiation. If either are not evident, it will be classed as RDM. This is primarily to stop one-or-no-sentence killings.", tags: ["rdm", "initiation", "reason", "killing"], new: true },
            { id: 211, category: "Core RP", title: "FailRP", text: "FailRP is not allowed. This includes doing things that you wouldn’t do or wouldn’t be able to do IRL, interfering with LEO/NHS RP scenes unless you have a valid RP reason to be there, and being a fake hostage at a bank robbery. If you are found to be doing a robbery naked (taking clothes off to hide identity) you will be made to put your clothes back on.", tags: ["failrp", "realism", "leo", "nhs", "hostage"], new: true },
            { id: 212, category: "Core RP", title: "GTA Driving / Realistic Consequences", text: "GTA Driving is now allowed to an extent. You are now allowed to do jumps, but these come with consequences as they need to be RP’d. For example, if you send your car flying off the side of a mountain, you are going to get hurt, so please RP it.", tags: ["gta driving", "realism", "consequences", "jumping"], new: true },
            { id: 213, category: "Core RP", title: "Vehicle in Buildings / Meth", text: "Vehicles are not allowed inside buildings. There will also be no meth cooking underground or in railway tunnels.", tags: ["vehicle", "meth", "underground"], new: true },
            { id: 214, category: "Core RP", title: "Impersonation and Military Zones", text: "Impersonating the NHS is not allowed unless permission is given by staff. This includes wearing any type of NHS clothing/accessories. It is also forbidden to enter the military base or the aircraft carrier (unless for your shop/trucking deliveries).", tags: ["impersonation", "nhs", "military", "restricted"], new: true },
            { id: 215, category: "Core RP", title: "Spawn/Hospital Killing", text: "It is forbidden to rob, kidnap, or kill new players at the character creation location or players who have just respawned at the hospital. Camping spawn locations is forbidden.", tags: ["spawn kill", "hospital", "camping", "new players"], new: true },
            { id: 216, category: "Core RP", title: "Terrorism RP", text: "Terrorism or Bomb RP in any way is not allowed unless cleared by a senior administrator. If you do do terrorist RP without authorization, the RP scene can continue, but your bomb will ultimately be classed as a dud. A fuel can does not count as a bomb.", tags: ["terrorism", "bomb rp", "extreme rp", "dud"], new: true },


            // --- Combat Rules (300-399) ---
            { id: 301, category: "Combat", title: "Vehicle Deathmatch (VDM)", text: "VDM is forbidden and will result in scaled punishments. Any direct or purposely aggressive action with vehicles will be classed as VDM.", tags: ["vdm", "vehicle", "aggressive"], new: false },
            { id: 302, category: "Combat", title: "Combat Logging (F8 Quitting) (Updated)", text: "Combat-logging, such as quitting the server during an RP situation/government sit will result in a punishment. F8 quitting or using any other means to quit while in an active RP scene will lead to a warning then bans. We have logs on how you exit, so this is easily found.", tags: ["combat logging", "disconnect", "f8 quit", "avoidance"], new: true },
            { id: 303, category: "Combat", title: "Heavily Armed Gangs", text: "Only approved, whitelisted gangs with sufficient members (minimum 6) can engage in large-scale shootouts. Casual combat groups are limited to 4 members.", tags: ["gangs", "shootout", "whitelist", "member count"], new: false },
            { id: 304, category: "Combat", title: "Hunting Rifles", text: "Using the hunting rifles against other players is not allowed under any circumstances. These are for hunting animals only. PERM BANS WILL BE GIVEN FOR ABUSING THIS RULE.", tags: ["hunting rifle", "weapon", "abuse", "perm ban"], new: true },
            { id: 305, category: "Combat", title: "Drive-Bys", text: "Do not shoot from the driver's seat of a car (you can shoot from a bike). Do not shoot out of any vehicle unless windows are down. Do not by any means shoot from an armoured car unless the windows are down or doors are open.", tags: ["drive-by", "shooting", "vehicle", "armoured"], new: true },
            { id: 306, category: "Combat", title: "Gang Member Limits", text: "Whitelisted Gangs are limited to a certain number of members, this can be discussed with the gang managers if the whitelist is successful.", tags: ["gangs", "member count", "whitelist"], new: true },
            { id: 307, category: "Combat", title: "Vehicle vs. Pedestrian/Structure", text: "You cannot use a vehicle to intentionally run over pedestrians or ram into buildings in a hostile manner unless it is part of a detailed, pre-planned RP scenario (and is not an attempt at griefing).", tags: ["vehicle", "ramming", "griefing", "hostile"], new: false },

            // --- Crime Rules (400-499) ---
            { id: 401, category: "Crime", title: "Robbery Limits (Updated)", text: "Players can only be robbed for a reasonable amount of cash and inventory items. Do not clear a player's entire bank account or all their assets. It is forbidden to force people to transfer/withdraw money from the bank, and it is also forbidden to force players to transfer you their vehicles.", tags: ["robbery", "limits", "bank", "inventory", "transfer"], new: true },
            { id: 402, category: "Crime", title: "Hostage Taking (Duration)", text: "A valid hostage must be a player who is not associated with the crime group and is clearly RPing fear. Staff intervention is often required for large-scale hostage situations. The maximum you can hold someone hostage for is 30 minutes, however, this rule does not apply if you are already engaged in a situation with the police, such as a bank robbery.", tags: ["hostage", "duration", "kidnapping", "staff"], new: true },
            { id: 403, category: "Crime", title: "Government/LEO/EMS Harassment", text: "Excessive or unrealistic harassment of Law Enforcement (LEO) or Emergency Medical Services (EMS) is prohibited. They are essential to the server's RP and must be respected.", tags: ["leo", "ems", "harassment", "government"], new: false },
            { id: 404, category: "Crime", title: "Police Raids (House Keys)", text: "IF police raid your house and you are inside or they wait for you to come home, then you must, when cuffed, give them your keys to the house. If you do not do this, it will be seen as Powergaming.", tags: ["police raid", "keys", "powergaming"], new: true },
            { id: 405, category: "Crime", title: "Robbery and Raids on Properties (Player Wait)", text: "We ask that players are given a chance by letting them be in the server before this happens, so please wait for the player in question to join before robbing or raiding their house. YOU DO NOT NEED TO FOLLOW THIS RULE UNLESS ANNOUNCED MI5 INACTIVE RULE.", tags: ["raid", "player wait", "mi5"], new: true },
            { id: 406, category: "Crime", title: "Daylight Saving Cameras", text: "If you are in the main city limits, it is daytime, and you proceed to kill officers, this will be classed as a street camera and a dead or alive warrant will be issued. Be careful.", tags: ["cameras", "daylight", "leo", "warrant"], new: true },
            { id: 407, category: "Crime", title: "Player Robbery (Specific Stealing Limits)", text: "NHS or Police issued weapons must NOT be stolen. You can '/me takes weapons'. The officer or NHS worker will then have to disregard the weapon in their inventory for the rest of the RP scene. You MAY steal GPS, AMMO, ARMOUR, EVIDENCE (= GUNS DRUGS MONEY BAGS ETC), HANDCUFFS, and CUFF KEYS that are on an officer. Anything else is fair game.", tags: ["robbery", "police", "nhs", "weapons", "limits"], new: true },
            { id: 408, category: "Crime", title: "Evidence", text: "Do not by any means take anything from police evidence. You will be banned from all whitelists for 1 month and, if decided, you will also be banned from the server.", tags: ["evidence", "police", "stealing", "ban"], new: true },
            { id: 409, category: "Crime", title: "Custody", text: "After being treated by the NHS or arrested by MPS (Police), you are in their custody until cleared or escaped. Not doing so will be treated as FailRP.", tags: ["custody", "nhs", "police", "failrp"], new: true },
            { id: 410, category: "Crime", title: "Bank Robbery Limits", text: "In a bank robbery, a maximum of 4 robbers are allowed inside the robbery or a maximum of 6 robbers are allowed inside the bobcat or big bank robbery, with a maximum of 2 hostages allowed.", tags: ["bank", "robbery", "limits", "hostages"], new: true },
            { id: 411, category: "Crime", title: "Restart Crime Limits", text: "No illegal activity is allowed 30 minutes before and 15 minutes after restart. Selling drugs, robbing a person, murdering a person, and discharging a firearm are not allowed 15 minutes before and 15 minutes after a restart.", tags: ["restart", "crime", "timing"], new: true },
            { id: 412, category: "Crime", title: "Kidnapping Cooldown", text: "You can only kidnap the same person or group once every 2 hours. If a member of your whitelisted gang has already kidnapped or murdered a player, no other member of your gang can initiate hostile RP towards that same player until that timer is up.", tags: ["kidnapping", "cooldown", "gangs"], new: true },
            { id: 413, category: "Crime", title: "Police Kidnapping", text: "You can kidnap police if there is an RP reason to do so and there has to be more than 1 officer online.", tags: ["police", "kidnapping", "leo"], new: true },
            { id: 414, category: "Crime", title: "NHS Hostile RP", text: "You are not to initiate any hostile RP towards the NHS. However, if they are hostile to you for any reason, you are able to retaliate accordingly. This also includes attempting to murder the person the NHS is giving medical treatment to secure a no revive.", tags: ["nhs", "hostile rp", "retaliate", "no revive"], new: true },
            { id: 415, category: "Crime", title: "Robbing Food", text: "It is forbidden to rob any food or drinks from players.", tags: ["robbery", "food", "drinks"], new: true },
            { id: 416, category: "Crime", title: "Forbidden Weapons to Steal", text: "It is forbidden to steal police-issued weapons/heavy ammo. These include: Combat Pistol, Stun gun, SMG, Special Carbine, Heavy Sniper, Pump Shotgun, and heavy ammo boxes.", tags: ["weapons", "police", "heavy ammo"], new: true },

            // --- Economy Rules (500-599) ---
            { id: 501, category: "Economy", title: "Selling Stolen Goods", text: "Selling stolen or illegally acquired items/vehicles requires legitimate RP interaction. You cannot use OOC chat or random teleportation to conduct illegal sales.", tags: ["selling", "stolen", "illegal", "rp"], new: false },
            { id: 502, category: "Economy", title: "Money Laundering", text: "Large amounts of illicit money must be laundered through RP-appropriate means. Arbitrary transfer of large sums of cash between players without a clear RP reason is considered exploiting.", tags: ["money laundering", "cash transfer", "exploit"], new: false },
            { id: 503, category: "Economy", title: "Triple Threat Shop Prices", text: "If you have items in your shop more than triple the item price and it's bought and reported, your shop will be removed.", tags: ["shop", "pricing", "exploit"], new: true },
            { id: 504, category: "Economy", title: "Redline Showroom Nitro Cars", text: "Redline Showroom Nitro Cars can not be used for anything except racing or city driving. No criminal elements involved. Your car will be taken and impounded if found on the road or left unattended. Transport cars using trailers to racing events or risk being chased.", tags: ["redline", "nitro", "racing", "impound", "crime"], new: true },
            { id: 505, category: "Economy", title: "Paycheck Farming", text: "Paycheck farming while AFK is not allowed. For example, being NHS/mechanics and going on duty and not doing your job is not allowed. This will result in a punishment or potential removal from your whitelisted job.", tags: ["paycheck", "afk", "farming", "job"], new: true },
            { id: 506, category: "Economy", title: "Business Owner - Employee Responsibility", text: "You have a responsibility for your employees. You must be able to pay their wages and make sure they follow the rules. Failing to do so will result in the termination of your business ownership.", tags: ["business", "employees", "wages"], new: true },
            { id: 507, category: "Economy", title: "Business Owner - Service Priority", text: "If you own a business that provides a service, such as mechanics, you must make sure you are providing that service. For example, you must repair and tune people’s vehicles as a mechanic, and prioritize this over any other activities, such as crime.", tags: ["business", "mechanic", "prioritize", "crime"], new: true },
            { id: 508, category: "Economy", title: "CID/Gang Conflict", text: "You may not be a part of a gang and CID (in the MPS) at the same time (this includes across characters and staff members, unless authorized).", tags: ["cid", "gang", "conflict", "whitelist job"], new: true },
            { id: 509, category: "Economy", title: "Corrupt Cop RP", text: "Corrupt cop RP is only allowed to overlook items in a search. No other corrupt whitelisted job RP is allowed.", tags: ["corrupt", "cop", "search"], new: true },
            { id: 510, category: "Economy", title: "Scamming", text: "It is not permitted to ‘scam’ players for their vehicles or sell vehicles on the phone app for more than a maximum value of £10mill. You may only ‘scam’ players for illegal items (such as weapons or heist equipment etc.) with a value of £500,000 or less.", tags: ["scamming", "vehicles", "illegal items", "money"], new: true },
            { id: 511, category: "Economy", title: "Real Estate - Cayo Perico", text: "Real estate must not conduct business or sell any properties on the Cayo Perico island.", tags: ["real estate", "cayo perico", "selling"], new: true },
            { id: 512, category: "Economy", title: "Real Estate - House Selling Value", text: "You must stick to the value that is on your sheet. You are only allowed to upsell to a certain percentage, which will only be disclosed to the real estate agents.", tags: ["real estate", "upsell", "value"], new: true },

            // --- Zones and Map Rules (600-699) ---
            { id: 601, category: "Zones", title: "Green Zones (Safe Zones) (Updated)", text: "No hostile actions (robbing, kidnapping, combat initiation) are allowed while inside designated Green Zones (e.g., Hospitals, JobCentre, Mechanic Shop, Real Estate Office, Police Impound, Trucking Building, Underground Racing Zone). While in Hostile RP or Combat, you must avoid these locations. If someone does run inside while in active RP, the RP scene can continue BUT the person may still be reported for the rule break.", tags: ["green zone", "safe zone", "combat", "hospital", "job centre"], new: true },
            { id: 602, category: "Zones", title: "Restricted Military/Airspace", text: "Military bases and restricted airspaces are off-limits unless you have explicit in-character permission (e.g., a LEO pilot) or staff approval for a specific scenario.", tags: ["military", "airspace", "restricted", "leo"], new: false },
            { id: 603, category: "Zones", title: "Character Creation Spawn Zone", text: "You must not initiate any hostile RP or combat inside the Character Creation Spawn Zone. Camping inside is forbidden. Hostile RP or combat MUST NOT be brought into these locations whatsoever.", tags: ["spawn", "camping", "hostile", "creation"], new: true },

            // --- Aircraft Rules (700-799) ---
            { id: 701, category: "Aircraft", title: "Low-Altitude Flying", text: "Aircraft must maintain a safe and reasonable altitude when flying over city centers and residential areas. Stunt flying in these areas is prohibited.", tags: ["aircraft", "flying", "altitude", "stunt"], new: false },
            { id: 702, category: "Aircraft", title: "Emergency Landing", text: "In the event of an aircraft emergency, the pilot must RP a realistic landing scenario and notify air traffic control (if present) or nearby LEO/EMS.", tags: ["aircraft", "landing", "emergency", "rp"], new: false },
            { id: 703, category: "Aircraft", title: "Theft and Military Vehicles", text: "You are allowed to steal aircraft, however, you are not allowed to steal military vehicles.", tags: ["aircraft", "stealing", "military"], new: true },
            { id: 704, category: "Aircraft", title: "Collisions and Life Value", text: "You must not deliberately collide with any other aircraft, people, or buildings whilst flying. You must value your life in an aircraft.", tags: ["collision", "value of life", "flying"], new: true },
            { id: 705, category: "Aircraft", title: "Realistic Flying", text: "You must fly realistically. This means you must not fly under bridges, close to buildings, etc. You must value your life in an aircraft.", tags: ["flying", "realism", "bridges"], new: true },
            { id: 706, category: "Aircraft", title: "Aircraft Garages", text: "You may only store aircraft in aircraft garages. Failure to do so will result in your aircraft being removed and your licenses being stripped. Additionally, you must not use the impound feature to bring out aircraft or boats at car garages.", tags: ["garage", "storage", "impound", "licenses"], new: true },
            { id: 707, category: "Aircraft", title: "Flying Zones", text: "You must not fly PLANES and LAND Helicopters in the zones marked red and blue unless it's on a helipad or runway. You must not fly HELICOPTERS in the zones marked blue. Landing needs to be realistic, no landing in the streets/garages or on top of houses (only NHS and Police are exempt).", tags: ["zones", "restricted", "planes", "helicopters", "landing"], new: true },

            // --- Discord Rules (800-899) ---
            { id: 801, category: "Discord", title: "Respect and Conduct", text: "All members must be treated with respect. Harassment, hate speech, racism, sexism, and toxicity towards other members or staff are strictly prohibited and will result in an immediate ban.", tags: ["discord", "respect", "conduct", "toxicity"], new: true },
            { id: 802, category: "Discord", title: "No Advertising", text: "Do not advertise other servers, websites, or services in any text channel or direct messages (DMs) to other members. Self-promotion is only allowed in designated channels if applicable.", tags: ["discord", "advertising", "spam"], new: true },
            { id: 803, category: "Discord", title: "Follow Discord ToS", text: "You must adhere to the official Discord Terms of Service and Community Guidelines at all times.", tags: ["discord", "tos", "guidelines"], new: false },
            { id: 804, category: "Discord", title: "Ticket System Usage", text: "Use the ticket system for all reports, ban appeals, and support inquiries. Do not direct message (DM) staff members for support unless explicitly told to do so.", tags: ["discord", "ticket", "support", "staff"], new: true },
            { id: 805, category: "Discord", title: "Spam and Pinging", text: "Do not spam text channels with messages, emojis, or caps. Do not ping staff members or roles without a valid reason. Mass pinging is prohibited.", tags: ["discord", "spam", "pinging"], new: false },
            { id: 806, category: "Discord", title: "Profile Guidelines", text: "Usernames, nicknames, and profile pictures must be appropriate (SFW) and not contain offensive language or imagery.", tags: ["discord", "profile", "nsfw", "username"], new: false },
            { id: 807, category: "Discord", title: "Channel Usage", text: "Ensure you are using the correct channels for their intended purpose (e.g., keeping general chat in #general, posting media in #media, etc.).", tags: ["discord", "channels", "topic"], new: false },
        ];

        // Init Rules from LocalStorage or Default
        let rulesData = JSON.parse(localStorage.getItem('ukrp_rules')) || defaultRulesData;

        // --- Auth Logic ---
        function checkSession() {
            if(sessionStorage.getItem('ukrp_admin_session') === 'true') {
                setAdminState(true);
            }
        }

        function openLoginModal() {
            document.getElementById('loginModal').classList.add('open');
            document.getElementById('adminUser').focus();
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('open');
            if(modalId === 'loginModal') {
                document.getElementById('loginError').classList.add('hidden');
                document.getElementById('adminUser').value = '';
                document.getElementById('adminPass').value = '';
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const user = document.getElementById('adminUser').value;
            const pass = document.getElementById('adminPass').value;
            const errorMsg = document.getElementById('loginError');

            // Hardcoded credentials for demo
            if (user === 'admin' && pass === 'ukrp2024') {
                setAdminState(true);
                sessionStorage.setItem('ukrp_admin_session', 'true');
                closeModal('loginModal');
            } else {
                errorMsg.classList.remove('hidden');
            }
        }

        function logout() {
            setAdminState(false);
            sessionStorage.removeItem('ukrp_admin_session');
        }

        function setAdminState(isLoggedIn) {
            isAdmin = isLoggedIn;
            const loginBtn = document.getElementById('adminLoginBtn');
            const panel = document.getElementById('adminPanel');
            
            if (isLoggedIn) {
                loginBtn.classList.add('hidden');
                panel.classList.remove('hidden');
                panel.classList.add('flex');
            } else {
                loginBtn.classList.remove('hidden');
                panel.classList.add('hidden');
                panel.classList.remove('flex');
            }
            filterRules(); // Re-render to show/hide edit buttons
        }


        // --- CRUD Logic ---

        function saveRules() {
            localStorage.setItem('ukrp_rules', JSON.stringify(rulesData));
            filterRules();
        }

        function openRuleModal(ruleId = null) {
            const modal = document.getElementById('ruleModal');
            const titleEl = document.getElementById('modalTitle');
            const idInput = document.getElementById('ruleId');
            const catInput = document.getElementById('ruleCategory');
            const titleInput = document.getElementById('ruleTitle');
            const textInput = document.getElementById('ruleText');
            const newCheck = document.getElementById('ruleNew');

            if (ruleId) {
                // Edit Mode
                const rule = rulesData.find(r => r.id === ruleId);
                if (!rule) return;
                
                titleEl.textContent = "Edit Rule";
                idInput.value = rule.id;
                catInput.value = rule.category;
                titleInput.value = rule.title;
                textInput.value = rule.text;
                newCheck.checked = rule.new;
            } else {
                // Add Mode
                titleEl.textContent = "Add New Rule";
                idInput.value = "";
                // Default category based on filter if possible
                catInput.value = (activeCategoryFilter !== 'All') ? activeCategoryFilter : "General";
                titleInput.value = "";
                textInput.value = "";
                newCheck.checked = true;
            }

            modal.classList.add('open');
        }

        function handleRuleSubmit(e) {
            e.preventDefault();
            const idInput = document.getElementById('ruleId').value;
            const category = document.getElementById('ruleCategory').value;
            const title = document.getElementById('ruleTitle').value;
            const text = document.getElementById('ruleText').value;
            const isNew = document.getElementById('ruleNew').checked;

            if (idInput) {
                // Update Existing
                const index = rulesData.findIndex(r => r.id == idInput);
                if (index !== -1) {
                    rulesData[index] = { ...rulesData[index], category, title, text, new: isNew };
                }
            } else {
                // Create New
                // Find highest ID
                const maxId = rulesData.reduce((max, r) => Math.max(max, r.id), 0);
                const newRule = {
                    id: maxId + 1,
                    category,
                    title,
                    text,
                    new: isNew,
                    tags: [] // Simplification: tags left empty for basic add
                };
                rulesData.push(newRule);
            }

            saveRules();
            closeModal('ruleModal');
        }

        function deleteRule(id) {
            if(confirm("Are you sure you want to delete this rule?")) {
                rulesData = rulesData.filter(r => r.id !== id);
                saveRules();
            }
        }

        // --- Review Form Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const starElements = document.querySelectorAll('.rating-star');
            const selectedRatingInput = document.getElementById('selectedRating');

            starElements.forEach(star => {
                star.addEventListener('click', () => {
                    const value = parseInt(star.getAttribute('data-value'));
                    selectedRatingInput.value = value;
                    updateStars(value);
                });

                star.addEventListener('mouseover', () => {
                    const value = parseInt(star.getAttribute('data-value'));
                    updateStars(value, true);
                });

                star.addEventListener('mouseout', () => {
                    const value = parseInt(selectedRatingInput.value) || 0;
                    updateStars(value);
                });
            });

            function updateStars(value, isHover = false) {
                starElements.forEach(star => {
                    const starValue = parseInt(star.getAttribute('data-value'));
                    if (isHover) {
                        if (starValue <= value) {
                            star.classList.add('hover-active');
                            star.classList.remove('selected');
                        } else {
                            star.classList.remove('hover-active');
                        }
                    } else {
                        star.classList.remove('hover-active');
                        if (starValue <= value) {
                            star.classList.add('selected');
                        } else {
                            star.classList.remove('selected');
                        }
                    }
                });
            }
        });

        // Profanity list for validation
        const profanityList = ["asshole", "bitch", "cunt", "damn", "dick", "fuck", "goddamn", "hell", "shit", "wank", "piss", "motherfucker", "fucker", "cock", "bastard", "tits", "nigga", "nigger", "fag", "gay", "retard", "autist", "kike", "chink", "pedo", "incest"];
        const forbiddenChars = ['#', '@'];

        async function submitReview(event) {
            event.preventDefault(); 
            const form = document.getElementById('reviewForm');
            const reviewMessage = document.getElementById('reviewMessage');
            const name = document.getElementById('reviewName').value.trim();
            const content = document.getElementById('reviewContent').value.trim();
            const rating = parseInt(document.getElementById('selectedRating').value, 10); // <-- MODIFIED: ParseInt
            
            reviewMessage.textContent = '';
            reviewMessage.classList.remove('text-red-500', 'text-green-500');

            const lowerContent = content.toLowerCase();
            const lowerName = name.toLowerCase();

            if (profanityList.some(word => lowerContent.includes(word) || lowerName.includes(word)) || forbiddenChars.some(char => content.includes(char) || name.includes(char))) {
                showMessage("Your review contains restricted language or profanity.", 'error');
                return;
            }

            if (content.length < 10) { showMessage("Review must be at least 10 characters long.", 'error'); return; }
            if (!rating || rating < 1 || rating > 5) { showMessage("Please select a star rating.", 'error'); return; } // <-- MODIFIED: Better check
            
            showMessage("Submitting...", 'loading');
            document.querySelector('#reviewForm button[type="submit"]').disabled = true;

            // --- START: NEW PAYLOAD LOGIC ---
            // Generate star visuals
            const stars = "⭐".repeat(rating);

            // Generate short review ID
            const reviewId = Math.floor(100000 + Math.random() * 900000);

            // Dynamic color + badge depending on rating
            let luxuryColor = 16098851; // default gold
            let badgeIcon = "https://dunb17ur4ymx4.cloudfront.net/packages/images/49342f8f9ad219236d2c6a0f1a549fd375219b4b.png"; // gold badge
            let banner = "https://unitingkingdomsrp.co.uk/logo_1.png"; // animated gold

            if (rating <= 2) {
                luxuryColor = 15158332; // red-ish
                badgeIcon = "https://dunb17ur4ymx4.cloudfront.net/packages/images/49342f8f9ad219236d2c6a0f1a549fd375219b4b.png"; // red badge
                banner = "https://unitingkingdomsrp.co.uk/logo_1.png"; // red shimmer
            } else if (rating === 3) {
                luxuryColor = 9807270; // silver
                badgeIcon = "https://dunb17ur4ymx4.cloudfront.net/packages/images/49342f8f9ad219236d2c6a0f1a549fd375219b4b.png"; // silver badge
                banner = "https://unitingkingdomsrp.co.uk/logo_1.png"; // silver shimmer
            } else if (rating === 4) {
                luxuryColor = 16766720; // gold
                badgeIcon = "https://dunb17ur4ymx4.cloudfront.net/packages/images/49342f8f9ad219236d2c6a0f1a549fd375219b4b.png"; 
                banner = "https://unitingkingdomsrp.co.uk/logo_1.png";
            } else if (rating === 5) {
                luxuryColor = 5793266; // diamond blue
                badgeIcon = "https://dunb17ur4ymx4.cloudfront.net/packages/images/49342f8f9ad219236d2c6a0f1a549fd375219b4b.png"; // diamond crest
                banner = "https://unitingkingdomsrp.co.uk/logo_1.png"; // diamond shimmer
            }

            const reviewPayload = {
                username: "UKRP •Reviews Bot",
                avatar_url: "https://unitingkingdomsrp.co.uk/logo_1.png",
                embeds: [
                    // MAIN REVIEW CARD
                    {
                        title: "💎 UKRP SERVER REVIEW 💎",
                        description: `A new very nice person posted a review thank you.`,
                        color: luxuryColor,
                        author: {
                            name: "",
                            icon_url: "https://unitingkingdomsrp.co.uk/logo_1.png"
                        },
                        thumbnail: {
                            url: badgeIcon
                        },
                        fields: [
                            {
                                name: "👤 Reviewer",
                                value: `**${name}**`,
                                inline: true
                            },
                            {
                                name: "⭐ Rating",
                                value: `**${stars} (${rating}/5)**`,
                                inline: true
                            },
                            {
                                name: "💬 Review",
                                value: `>>> ${content}`
                            },
                            {
                                name: "🆔 Review ID",
                                value: `\`${reviewId}\``,
                                inline: true
                            },
                            {
                                name: "📅 Submitted",
                                value: `<t:${Math.floor(Date.now() / 1000)}:f>`,
                                inline: true
                            }
                        ],
                        image: {
                            url: banner // animated luxury banner
                        },
                        footer: {
                            text: "UKRP Review System ",
                            icon_url: "https://unitingkingdomsrp.co.uk/logo_1.png"
                        },
                        timestamp: new Date().toISOString()
                    },
                ]
            };
            // --- END: NEW PAYLOAD LOGIC ---


            const MAX_RETRIES = 3;
            let currentRetry = 0;

            const makeRequest = async () => {
                try {
                    const response = await fetch(DISCORD_WEBHOOK_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(reviewPayload),
                    });

                    if (response.ok) {
                        showMessage("Thank you! Your review has been submitted for approval.", 'success');
                        form.reset();
                        document.querySelectorAll('.rating-star').forEach(s => s.classList.remove('selected', 'hover-active'));
                        document.getElementById('selectedRating').value = '';
                    } else if (response.status === 429) {
                        const delay = Math.pow(2, currentRetry) * 1000 + (Math.random() * 1000);
                        if (currentRetry < MAX_RETRIES) {
                            currentRetry++;
                            await new Promise(resolve => setTimeout(resolve, delay));
                            await makeRequest();
                        } else { throw new Error('Too many requests.'); }
                    } else { throw new Error('Submission failed.'); }
                } catch (error) {
                    showMessage(`An error occurred. Please try again.`, 'error');
                } finally {
                    if (currentRetry === 0 || currentRetry === MAX_RETRIES || reviewMessage.textContent.includes('submitted') || reviewMessage.textContent.includes('error')) {
                        document.querySelector('#reviewForm button[type="submit"]').disabled = false;
                    }
                }
            };
            await makeRequest();
        }

        function showMessage(message, type) {
            const reviewMessage = document.getElementById('reviewMessage');
            reviewMessage.textContent = message;
            reviewMessage.classList.remove('text-red-500', 'text-green-500', 'text-yellow-500');
            if (type === 'error') reviewMessage.classList.add('text-red-500');
            else if (type === 'success') reviewMessage.classList.add('text-green-500');
            else if (type === 'loading') reviewMessage.classList.add('text-yellow-500');
        }


        // --- Render Logic ---

        function renderRules(filteredRules) {
            const container = document.getElementById('ruleContainer');
            container.innerHTML = ''; 

            if (filteredRules.length === 0) {
                container.innerHTML = `<p class="text-xl text-center text-gray-400 mt-10">No rules found matching your current search term or category filter.</p>`;
            }
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                if (btn.getAttribute('data-category') === activeCategoryFilter) {
                    btn.classList.add('active', 'ring-2', 'ring-blue-400', 'transform', 'scale-[1.05]');
                    btn.classList.remove('hover:bg-gray-700', 'hover:scale-[1.00]');
                } else {
                    btn.classList.remove('active', 'ring-2', 'ring-blue-400', 'transform', 'scale-[1.05]');
                    btn.classList.add('hover:bg-gray-700');
                }
            });

            const categoryMap = {
                "General": { color: 'var(--color-general)', class: 'general-rule' },
                "Whitelist": { color: 'var(--color-whitelist)', class: 'whitelist-rule' },
                "Core RP": { color: 'var(--color-core-rp)', class: 'core-rp-rule' },
                "Combat": { color: 'var(--color-combat)', class: 'combat-rule' },
                "Crime": { color: 'var(--color-crime)', class: 'crime-rule' },
                "Economy": { color: 'var(--color-economy)', class: 'economy-rule' },
                "Zones": { color: 'var(--color-zones)', class: 'zones-rule' },
                "Aircraft": { color: 'var(--color-aircraft)', class: 'aircraft-rule' },
                "Discord": { color: 'var(--color-discord)', class: 'discord-rule' },
            };

            const groupedRules = filteredRules.reduce((acc, rule) => {
                if (!acc[rule.category]) acc[rule.category] = [];
                acc[rule.category].push(rule);
                return acc;
            }, {});


            for (const category in groupedRules) {
                const map = categoryMap[category] || categoryMap["General"]; 
                
                const categorySection = document.createElement('div');
                categorySection.className = 'mb-10';
                categorySection.innerHTML = `
                    <h3 class="text-3xl font-extrabold mb-4 pt-4 sticky top-[72px] bg-gray-900/95 backdrop-blur-sm z-40 p-2 rounded-lg" style="color: ${map.color}; border-bottom: 2px solid ${map.color};">
                        ${category} Rules
                    </h3>
                `;
                container.appendChild(categorySection);

                const rulesGrid = document.createElement('div');
                rulesGrid.className = 'grid grid-cols-1 md:grid-cols-2 gap-6';
                categorySection.appendChild(rulesGrid);

                groupedRules[category].forEach(rule => {
                    const ruleCard = document.createElement('div');
                    ruleCard.className = `rule-card p-5 rounded-xl ${map.class}`;
                    
                    const newTag = rule.new ? '<span class="new-rule-tag text-xs font-bold py-1 px-2 rounded-full text-white inline-block ml-3">NEW</span>' : '';
                    
                    // Admin Buttons
                    let adminBtns = '';
                    if (isAdmin) {
                        adminBtns = `
                            <div class="absolute top-4 right-4 flex space-x-2">
                                <button onclick="openRuleModal(${rule.id})" class="p-1 bg-blue-600 rounded text-white hover:bg-blue-500" title="Edit">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                                </button>
                                <button onclick="deleteRule(${rule.id})" class="p-1 bg-red-600 rounded text-white hover:bg-red-500" title="Delete">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                </button>
                            </div>
                        `;
                    }

                    ruleCard.innerHTML = `
                        ${adminBtns}
                        <h4 class="text-xl font-bold mb-2 flex items-center pr-12" style="color: ${map.color};">
                            #${rule.id} - ${rule.title} ${newTag}
                        </h4>
                        <p class="text-gray-300 text-base">${rule.text}</p>
                    `;
                    rulesGrid.appendChild(ruleCard);
                });

                if (category === "Aircraft") {
                    const imageContainer = document.createElement('div');
                    imageContainer.className = 'mt-6 w-full flex justify-center';
                    imageContainer.innerHTML = `
                        <img src="https://i.gyazo.com/fad0f3f014c5988a6ac3218d7409e33f.png" 
                             alt="Aircraft Rules Map" 
                             class="rounded-xl shadow-lg border-2 border-gray-700 max-w-full h-auto hover:scale-[1.01] transition-transform duration-300">
                    `;
                    categorySection.appendChild(imageContainer);
                }
            }
        }

        function filterRules() {
            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearchBtn');
            const searchTerm = searchInput.value.toLowerCase().trim();
            
            if (searchTerm.length > 0) clearButton.classList.remove('hidden');
            else clearButton.classList.add('hidden');

            let filtered = rulesData;

            if (searchTerm) {
                filtered = filtered.filter(rule => 
                    rule.title.toLowerCase().includes(searchTerm) ||
                    rule.text.toLowerCase().includes(searchTerm) ||
                    rule.category.toLowerCase().includes(searchTerm) ||
                    rule.tags.some(tag => tag.includes(searchTerm))
                );
            }

            if (activeCategoryFilter && activeCategoryFilter !== 'All') {
                filtered = filtered.filter(rule => rule.category === activeCategoryFilter);
            }
            renderRules(filtered);
        }

        function filterByCategory(category) {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = ''; 
            if (activeCategoryFilter === category && category !== 'All') activeCategoryFilter = 'All';
            else activeCategoryFilter = category;
            filterRules();
            document.getElementById('rules').scrollIntoView({ behavior: 'smooth' });
        }


        window.onload = function () {
            checkSession();
            filterRules();

            const searchInput = document.getElementById('searchInput');
            const clearButton = document.getElementById('clearSearchBtn');
            let debounceTimer;

            searchInput.addEventListener('input', () => {
                clearTimeout(debounceTimer);
                activeCategoryFilter = 'All'; 
                debounceTimer = setTimeout(filterRules, 300);
            });

            clearButton.addEventListener('click', () => {
                searchInput.value = '';
                filterRules(); 
                searchInput.focus(); 
            });

            const backToTopBtn = document.getElementById('backToTopBtn');
            window.onscroll = function() {
                if (document.body.scrollTop > 400 || document.documentElement.scrollTop > 400) {
                    backToTopBtn.style.opacity = '1';
                    backToTopBtn.style.transform = 'translateY(0)';
                    backToTopBtn.style.pointerEvents = 'auto';
                } else {
                    backToTopBtn.style.opacity = '0';
                    backToTopBtn.style.transform = 'translateY(20px)';
                    backToTopBtn.style.pointerEvents = 'none';
                }
            };

            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        };
    </script>
</body>
</html>