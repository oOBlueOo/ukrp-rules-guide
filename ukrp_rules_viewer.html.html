<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UKRP Rules & Reference Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Dark background */
            color: #c9d1d9; /* Light text */
        }
        .rule-table th, .rule-table td {
            padding: 12px;
            border-bottom: 1px solid #30363d; /* Darker border */
            text-align: left;
        }
        .rule-table th {
            background-color: #161b22; /* Slightly darker header */
            color: #58a6ff; /* Highlighted text */
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
        }
        .rule-item:hover {
            background-color: #1f242c; /* Hover effect */
        }
        .section-header {
            border-left: 4px solid #3fb950; /* Green highlight */
            padding-left: 1rem;
        }
        .search-input:focus {
            ring-color: #58a6ff;
            border-color: #58a6ff;
        }
        /* Style for the sticky navigation */
        .sticky-nav {
            top: 1rem;
            max-height: calc(100vh - 2rem);
            overflow-y: auto;
            /* Hide scrollbar for aesthetics */
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .sticky-nav::-webkit-scrollbar {
            display: none; /* Chrome, Safari and Opera */
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="mb-8 p-4 bg-[#161b22] rounded-lg shadow-xl border border-[#30363d]">
            <h1 class="text-4xl font-extrabold text-[#58a6ff] mb-2">UKRP Server Rules</h1>
            <p class="text-lg text-[#8b949e]">All players must read and understand these rules. Use the search bar or side navigation to find specific topics quickly.</p>
        </header>

        <!-- Main Content Grid -->
        <div class="lg:grid lg:grid-cols-4 lg:gap-8">
            
            <!-- Sticky Navigation (Side Tab) -->
            <nav id="sideNav" class="hidden lg:block lg:col-span-1 sticky-nav p-4 bg-[#161b22] rounded-lg shadow-lg border border-[#30363d] self-start">
                <h3 class="text-xl font-bold text-white mb-4 border-b border-[#30363d] pb-2">Rule Categories</h3>
                <!-- Links generated by JS -->
            </nav>

            <!-- Main Rules and Search Area -->
            <div class="lg:col-span-3">
                
                <!-- Search Bar with Clear Button and No Results Message -->
                <div class="mb-8 sticky top-4 z-10 bg-[#0d1117] pt-4 -mt-4">
                    <div class="relative">
                        <input type="text" id="ruleSearch" placeholder="Search by topic, rule number, or summary..."
                               class="search-input w-full p-3 pr-10 rounded-lg bg-[#21262d] text-white border border-[#30363d] focus:outline-none focus:ring-2 transition duration-150 shadow-md">
                        <!-- Clear Button -->
                        <button id="clearSearch" class="absolute right-0 top-0 mt-3 mr-3 text-[#8b949e] hover:text-[#c9d1d9] hidden" aria-label="Clear Search">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                    <!-- No Results Message -->
                    <div id="noResults" class="hidden text-center mt-6 text-xl text-[#e37e7e] p-4 rounded-lg bg-[#161b22] border border-[#30363d]">
                        No rules found matching your search query. Try different keywords.
                    </div>
                </div>

                <main id="rulesContainer">
                    <!-- Rules will be rendered here by JavaScript -->
                </main>
            </div>
            <!-- End Main Rules and Search Area -->
        </div>
        <!-- End Main Content Grid -->


        <footer class="mt-12 pt-6 border-t border-[#30363d] text-center text-sm text-[#8b949e]">
            &copy; UKRP Community Guide. Organized for clarity and ease of access.
        </footer>
    </div>

    <script>
        // Data structure derived directly from UKRP_Categorized_Rules.md
        const rulesData = [
            {
                id: 'section1',
                title: "Section 1: General Server Rules & OOC Conduct",
                description: "This section covers rules regarding player behavior, staff interaction, and anything that is not considered 'In Character' (IC) roleplay.",
                rules: [
                    { topic: "Server Authority & Common Sense", original: "1.0, 1.5, 1.8", summary: "Staff have the final say on all rulings. Report staff issues on Discord. Use common sense; if you think something is questionable, it probably is." },
                    { topic: "Respect & Toxicity", original: "1.0, 1.5", summary: "Respect all players (IC and OOC). No OOC drama, toxicity, or personal attacks. Directed bigoted language or slurs will result in an immediate and severe ban." },
                    { topic: "Reporting & Admin Situations", original: "1.6, 1.7", summary: "Use /report for in-game issues. Wait until the RP is completely over to report. Do not interrupt staff situations. All reports require clear evidence. Do not abuse the system to regain lost items." },
                    { topic: "Server/Player Requirements", original: "1.2, 1.3, 1.9.2, 7.8", summary: "A working microphone is required. Must understand and speak English. Offensive or derogatory character names are not allowed. Character deletion is your own responsibility; create a ticket if you wish to keep any items." },
                    { topic: "Exploitation & Monetization", original: "1.9.3, 1.9.4", summary: "Exploiting bugs/glitches, using crosshairs, or lag-switching is forbidden. All bugs must be reported immediately. The transfer of real-world money or goods for in-game assets is permanently forbidden." },
                    { topic: "Miscellaneous OOC", original: "1.9.1, 7.7", summary: "No non-authorized advertising. Leaking private information from the Discord or UKRP is strictly forbidden." },
                ]
            },
            {
                id: 'section2',
                title: "Section 2: Whitelist & Character Rules",
                description: "This section focuses on the requirements and status of your character on the server.",
                rules: [
                    { topic: "Whitelist Application", original: "1, 2", summary: "The first application is reviewed leniently, the second is stricter. You must demonstrate an understanding of all server rules." },
                    { topic: "Whitelist Activity", original: "3, 4.6", summary: "Whitelisted players must maintain an average of at least 5 hours of playtime per week. You must maintain an average of 7 hours per week for your specific whitelisted job/role. Only one whitelisted job/role is permitted per person." },
                    { topic: "Character & Appearance", original: "2.1", summary: "Character names and clothing must be realistic and appropriate for the UK setting. Unsuitable names may force a character recreation." },
                ]
            },
            {
                id: 'section3',
                title: "Section 3: Core Roleplay (IC) Mechanics",
                description: "This section outlines the rules necessary to maintain a realistic and fair roleplaying environment.",
                rules: [
                    { topic: "Maintaining Character (IC/OOC)", original: "1.1, 3.3", summary: "You must remain In-Character (IC) at all times while in the server. OOC should only be initiated by a moderator. Do not break character by discussing real life, lag, or server rules in-game." },
                    { topic: "Metagaming", original: "1.4, 4.5", summary: "Do not use out-of-character knowledge (e.g., streams, Discord, OOC chat) for IC gain. If you are in a Discord/VOIP call during active RP, you must deafen or disconnect." },
                    { topic: "Valuing Life (FTVL)", original: "3.2", summary: "You must value your life and comply with demands if clearly outnumbered, cornered, or at a significant disadvantage." },
                    { topic: "New Life Rule (NLR)", original: "3.1", summary: "After death, you cannot remember your previous life (who killed you, where you died). You cannot return to the place of death until the RP scene is over. NLR is nullified only if revived by a Witch Doctor or NHS personnel." },
                    { topic: "FailRP & Realism", original: "2.7, 2.8, 2.5", summary: "Do not do things you cannot do in real life (FailRP). Interfering with police/NHS scenes without a valid IC reason is FailRP. Excessive and unrealistic 'GTA Driving' must be roleplayed as causing injuries." },
                    { topic: "Power-Gaming", original: "2.5", summary: "Spam punching, cancelling animations, or using unrealistic mechanics (e.g., 'sunbathing' through doors to look inside) is forbidden." },
                    { topic: "Combat-Logging", original: "1.9, 3.4", summary: "F8 Quitting or disconnecting during an active RP scene or staff interaction will result in a ban." },
                    { topic: "Extreme RP", original: "2.0, 2.2", summary: "**Suicide RP is permanent character death** (the character will be deleted). Any type of forced sexual (Erotic) RP is strictly forbidden and will result in a permanent ban." },
                ]
            },
            {
                id: 'section4',
                title: "Section 4: Combat & Killing Rules",
                description: "This section details all rules related to physical aggression, death, and use of force.",
                rules: [
                    { topic: "Initiation & Reason", original: "2.3, 2.3.1", summary: "**Random Deathmatch (RDM) is forbidden.** When attacking, you must have both clear **initiation** and a clear **reason**. One-or-no-sentence killings are considered RDM." },
                    { topic: "Vehicle Use in Combat (VDM)", original: "2.4", summary: "**Vehicle Deathmatch (VDM) is forbidden.** Any purposely aggressive action involving hitting or running over other players with a vehicle is VDM." },
                    { topic: "Death Animation", original: "0.1", summary: "If your character dies, you must press 'E' immediately to re-enter the death animation. **Do not hold 'E' to respawn**; this is FailRP." },
                    { topic: "Drive-Bys & Weapons", original: "3.2.3.1, 2.7.1", summary: "Do not shoot from the driver's seat (motorcycles allowed). Do not shoot out of any vehicle unless the windows are down. **Hunting Rifles are for animals only** and cannot be used against players (PERM BAN)." },
                    { topic: "Spawn/New Player Protection", original: "3.9", summary: "It is forbidden to rob, kidnap, or kill new players at the character creation or hospital spawn locations. Camping spawn locations is also forbidden." },
                ]
            },
            {
                id: 'section5',
                title: "Section 5: Criminal & Law Enforcement Rules",
                description: "Rules specific to illegal activities and interactions with Police (MPS), NHS, and government factions.",
                rules: [
                    { topic: "Crime Timers & Restarts", original: "5.1", summary: "No illegal activity 30 minutes before and 15 minutes after a server restart (for major crime like banks). No murder/robbery/drug selling 15 minutes before and 15 minutes after restart." },
                    { topic: "Robbery & Hostage Limits", original: "4.9, 5.5", summary: "Max **4 robbers** in a standard bank. Max **6 robbers** in Bobcat/Big Bank. Max **2 hostages** are allowed. Maximum hostage time is **30 minutes** (unless actively engaged with police)." },
                    { topic: "Law Enforcement Interaction", original: "5.4, 5.6", summary: "You can kidnap police if there is a valid RP reason and more than one officer is online. You are **not** to initiate hostile RP towards the NHS (retaliation is allowed if they are hostile)." },
                    { topic: "Custody & Escape", original: "4.4", summary: "After treatment/arrest, you are considered to be in NHS or MPS custody until you are officially cleared or have successfully escaped." },
                    { topic: "Kidnapping & Financial Limits", original: "5.3, 3.5", summary: "You can only kidnap the same person/group once every **2 hours**. It is forbidden to force people to transfer money or vehicles (including bank transfers)." },
                    { topic: "Criminal Theft & Contraband", original: "3.2.4, 6.1, 5.9", summary: "Do not steal police-issued heavy weapons or heavy ammo. You can /me take an officer's non-heavy weapon, GPS, armor, handcuffs, and cuff keys. It is forbidden to rob any food or drinks from players." },
                    { topic: "Raids & Evidence", original: "1.9.5, 1.9.6, 4.3", summary: "If raided while home, you must give police your house keys when cuffed. You must wait for the player to join the server before robbing/raiding their property. Do not take anything from police evidence (1 month whitelist ban)." },
                    { topic: "Corruption & Special Rules", original: "5.7, 5.8, 6.2", summary: "You cannot be part of a criminal gang and CID simultaneously. Corrupt cop RP is limited to overlooking items in a search. Terrorism/Bomb RP is not allowed unless cleared by a senior admin." },
                ]
            },
            {
                id: 'section6',
                title: "Section 6: Businesses, Property & Economy",
                description: "This section covers rules for whitelisted businesses, real estate, and financial transactions.",
                rules: [
                    { topic: "Business Operations", original: "4.7, 4.8", summary: "Business owners are responsible for paying employee wages and ensuring employees follow rules. Businesses (e.g., mechanics) must prioritize providing their service over other activities (e.g., crime)." },
                    { topic: "Sales & Scamming", original: "1.9.8, 6.6", summary: "Shop items cannot be priced more than **triple** the item's purchase price (shop removal if reported). Scamming for vehicles is not permitted. You may only scam players for illegal items (weapons, heist gear) with a maximum value of **Â£500,000**." },
                    { topic: "Real Estate", original: "7.4, 7.5", summary: "Real estate must not conduct business or sell properties on Cayo Perico Island. Real estate agents must stick to the agreed-upon value (upselling percentage is disclosed to agents)." },
                    { topic: "Vehicle Use", original: "3.2.3", summary: "Redline Showroom Nitro Cars cannot be used for criminal elements; they are for racing/city driving only. They should be transported via trailers." },
                ]
            },
            {
                id: 'section7',
                title: "Section 7: Zone & Vehicle Placement Rules",
                description: "This section outlines rules for specific locations, including 'Green Zones' where hostile RP is restricted.",
                rules: [
                    { topic: "Designated Green Zones", original: "6.4, 6.5", summary: "Hospitals, Job Centre, Mechanic Shop, Real Estate Office, Police Impound, Trucking Building, Underground Racing Zone, and Character Creation Spawn." },
                    { topic: "Green Zone Conduct", original: "6.4, 6.5", summary: "Hostile RP or combat must **not** be initiated inside these areas. If active RP enters a Green Zone, the RP may continue, but the rule-breaker may still be reported. Camping inside is forbidden." },
                    { topic: "Vehicle Placement", original: "5.2", summary: "Vehicles are not allowed inside buildings. No meth cooking underground or in railway tunnels." },
                    { topic: "Restricted Areas", original: "3.8", summary: "Impersonating the NHS or entering the military base/aircraft carrier (unless for business deliveries) is forbidden." },
                ]
            },
            {
                id: 'section8',
                title: "Section 8: Aircraft Rules",
                description: "Specific rules for the use of planes and helicopters. The Restricted Flying Zone map is shown below.",
                imageUrl: "https://i.imgur.com/8Qj9N9o.png", // Using a stable external image for the map
                rules: [
                    { topic: "General Flying", original: "7.0, 7.1", summary: "You must not deliberately collide with aircraft, people, or buildings. You must fly realistically (no flying under bridges or close to buildings). You must value your life in an aircraft." },
                    { topic: "Aircraft Storage", original: "7.2", summary: "You may only store aircraft in aircraft garages. Do not use the impound feature to bring out aircraft or boats at car garages." },
                    { topic: "Flying Zones", original: "7.3", summary: "**Planes and Helicopters** must not be flown/landed in the zones marked red and blue (except on helipads/runways). **Helicopters** must not be flown in the zones marked blue. Landing must be realistic (no landing on streets/garages/houses, except for NHS and Police). **See Map Below for Visual Reference.**" },
                    { topic: "Theft", original: "4.2", summary: "You are allowed to steal aircraft, but military vehicles are forbidden." },
                ]
            }
        ];

        const rulesContainer = document.getElementById('rulesContainer');
        const sideNav = document.getElementById('sideNav');

        // Function to render the rule tables AND the navigation links
        function renderRules(data) {
            rulesContainer.innerHTML = ''; // Clear previous content
            sideNav.innerHTML = '<h3 class="text-xl font-bold text-white mb-4 border-b border-[#30363d] pb-2">Rule Categories</h3>';
            
            const navList = document.createElement('ul');
            navList.className = "space-y-2";
            
            data.forEach(section => {
                // 1. Render Navigation Link
                const navLink = document.createElement('a');
                navLink.href = `#${section.id}`;
                navLink.className = "block p-2 rounded-md text-[#c9d1d9] hover:bg-[#21262d] hover:text-[#58a6ff] transition duration-150 text-sm font-medium";
                // Only show the section title in the nav, stripping the "Section X: " part for cleaner look
                navLink.textContent = section.title.split(': ').slice(1).join(': ') || section.title;
                
                // Add smooth scroll behavior
                navLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    document.getElementById(section.id).scrollIntoView({ behavior: 'smooth' });
                });
                
                const navItem = document.createElement('li');
                navItem.appendChild(navLink);
                navList.appendChild(navItem);


                // 2. Render Rule Content
                let imageHtml = '';
                if (section.imageUrl) {
                    // This logic specifically targets the Aircraft Rules section
                    if (section.id === 'section8') {
                        imageHtml = `
                            <div class="mt-6 mb-4 p-4 bg-[#21262d] rounded-lg border border-[#30363d] text-center">
                                <img src="${section.imageUrl}" alt="${section.title} Map" 
                                     class="w-full h-auto max-h-96 object-contain rounded-md mx-auto border border-[#58a6ff] shadow-xl">
                                <p class="mt-3 text-sm text-[#58a6ff] font-semibold">Visual Reference: Restricted Flying Zones (The red area indicates no-fly/no-land zones)</p>
                            </div>
                        `;
                    }
                }

                const sectionHtml = `
                    <section id="${section.id}" class="mb-10 p-6 bg-[#161b22] rounded-lg shadow-lg border border-[#30363d]">
                        <h2 class="text-3xl font-bold mb-2 section-header text-white">${section.title}</h2>
                        <p class="text-[#8b949e] mb-4">${section.description}</p>
                        ${imageHtml} <!-- Insert image placeholder/map here -->
                        <table class="w-full rule-table rounded-lg overflow-hidden">
                            <thead>
                                <tr class="bg-[#1f242c]">
                                    <th class="w-1/4 rounded-tl-lg">Topic</th>
                                    <th class="w-1/12">Rule #</th>
                                    <th class="w-2/3 rounded-tr-lg">Summary of Rules</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${section.rules.map(rule => `
                                    <tr class="rule-item" data-search="${(rule.topic + rule.original + rule.summary).toLowerCase()}">
                                        <td class="font-semibold text-white">${rule.topic}</td>
                                        <td class="text-xs text-[#58a6ff]">${rule.original}</td>
                                        <td>${rule.summary}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </section>
                `;
                rulesContainer.insertAdjacentHTML('beforeend', sectionHtml);
            });
            
            sideNav.appendChild(navList);
        }

        // Search and Filtering Logic
        window.onload = () => {
            renderRules(rulesData);
            
            const searchInput = document.getElementById('ruleSearch');
            const clearButton = document.getElementById('clearSearch');
            const noResultsDiv = document.getElementById('noResults');
            const allRuleItems = document.querySelectorAll('.rule-item');
            const sections = document.querySelectorAll('section');
            const navLinks = sideNav.querySelectorAll('a');


            // Function to filter rules based on search input
            function filterRules() {
                const query = searchInput.value.toLowerCase().trim();
                let visibleRuleCount = 0;
                
                // Track which sections still have visible rules
                const sectionVisibility = {};
                rulesData.forEach(section => sectionVisibility[section.id] = false);

                // Toggle Clear Button Visibility
                clearButton.style.display = query ? 'block' : 'none';

                allRuleItems.forEach(item => {
                    const searchData = item.getAttribute('data-search');
                    // Match if query is empty OR data includes query
                    const isMatch = !query || searchData.includes(query);
                    
                    // Toggle rule visibility
                    item.style.display = isMatch ? '' : 'none';

                    // If a rule matches, count it and mark its section as visible
                    if (isMatch) {
                        visibleRuleCount++;
                        const section = item.closest('section');
                        if (section) {
                            sectionVisibility[section.id] = true;
                        }
                    }
                });

                // Toggle Section Visibility
                sections.forEach(sectionElement => {
                    const sectionId = sectionElement.id;
                    const isVisible = sectionVisibility[sectionId];
                    sectionElement.style.display = isVisible ? 'block' : 'none';
                    
                    // Also update side nav link style based on visibility (only relevant when searching)
                    const navLink = sideNav.querySelector(`a[href="#${sectionId}"]`);
                    if (navLink) {
                         if (query) {
                             // During search, highlight only visible categories
                             navLink.classList.toggle('opacity-100', isVisible);
                             navLink.classList.toggle('opacity-30', !isVisible);
                         } else {
                             // Reset opacity when search is empty
                             navLink.classList.remove('opacity-30');
                             navLink.classList.add('opacity-100');
                         }
                    }
                });

                // Toggle "No Results" message only if there is an active query
                noResultsDiv.style.display = (visibleRuleCount === 0 && query) ? 'block' : 'none';
            }
            
            // Attach listeners
            searchInput.addEventListener('input', filterRules);
            
            clearButton.addEventListener('click', () => {
                searchInput.value = '';
                filterRules(); // Re-run filter to show all
                searchInput.focus(); // Keep focus for user
            });

            // Initial call to set up the clear button state
            filterRules();
        };
    </script>

</body>
</html>